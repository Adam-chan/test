<div class="row" style="padding:0 25px">
	<input id="premisesId" value="${premisesId!}" type="hidden">
	<div class=" col-xs-12">
		<div class="row">
			<div class=" col-xs-2">
			<label class="control-label">设置图片类型：</label> 
			</div>
			<div class=" col-xs-4">
				<select id="picTypes" class="input-xs form-control"
					style="width: 120px">
					<option value=""></option>
					<option value="1">总规图</option>
					<option value="2">楼盘位置图</option>
					<option value="3">项目外观图</option>
					<option value="4">项目景观图</option>
					<option value="5">栋座外观图</option>
					<option value="6">平曾剖面图</option>
					<option value="7">原始户型图</option>
				</select>
			</div>
			<div class=" col-xs-1">
			<form id="form" enctype="multipart/form-data">
			<a href="javascript:void(0);"
			style="position: relative;overflow: hidden;display: block;width: 95px;float: right;height: 50px;color:#0196ff;">
			<input onchange="fileUpload();" name="pic" type="file" class="btn btn-sm"
			style="position: absolute;top: -6px;left: -74px;opacity: 0;border: 0;width: 340px;height: 70px!important;line-height: 70px!important; cursor: pointer;" />
			<button class="">上传图片</button>
		</a>
	</form>
			</div>
		</div>
	</div>
	<div class=" col-xs-12">
		<label for="" class="control-label">已选择的图片名称：</label>
	</div>
	<div class=" col-xs-12">
		<div class='tags col-xs-12' id="fileUploaded"
			style="border:0;width:100%"></div>
	</div>
	
	

</div>
<script type="text/javascript">
	var original = "";
	function fileUpload() {
		var formData = new FormData($("#form")[0]);
			$.ajax({
					url : "${UPLOAD_URL}/save.do",
					type : "POST",
					data : formData,
					dataType : "JSON",
					async : false,
					processData : false,
					contentType : false,
					success : function(data) {
						$("#fileUploaded")
								.append(
										
										 '<span style="border:0px;position:relative;" class="tags dataFiles" data-original="'+data.original+'" data-folderName="'+data.folderName+'" data-fileName="'+data.fileName+'" ><div>'
										+'</div><img src="${IMAGE_URL}'+ data.folderName + '/' + data.fileName + '@180w_180h" style="cursor:pointer;" /><div>'+data.original
										+ '</div><button style="position:absolute; z-index:2; right:25px; top:10px" type="button" class="close " onclick="closeSpan(this);"><div style="color:red;font-size:30px;">×</div></button></span>')
										
					},
					error : function(data) {
						alert("上传失败");
					}
				});
	}

	//保存下载资料
	function saveUploadPicture() {
		var isSelect=$("#picTypes").val();
		if(isSelect == ''){
			alert("请设置图片类型");
			return false;
		}
		
		var dataStr = "[";
		var list = $("#fileUploaded").find(".dataFiles");
		list.each(function(i) {
			var folderName = $(this).attr("data-folderName");
			var fileName = $(this).attr("data-fileName");
			var original = $(this).attr("data-original");
			dataStr += '{"folderName":"' + folderName + '","fileNameLong":"'
					+ fileName + '","fileName":"' + original + '"}';
			if (i != list.length - 1) {
				dataStr += ',';
			}
		});
		dataStr += "]";
		var url = "${CTX}/premisesPictures/saveUploadPicture.do";
		$.ajax({
			type : "POST",
			url : url,
			async : false,
			dataType : "JSON",
			data : {
				"premisesId" : $("#premisesId").val(),
				"dataStr" : dataStr,
				"picType" :$("#picTypes").val(),
				"status"  :1,
				"isCover"  :1
			},
			success : function(data) {
				if (data >= 1) {
					alert("操作成功");
				} else {
					alert("操作失败");
				}
			}
		});
		return true;
	}

	function closeSpan(obj) {
		$(obj).parent().remove();
	}//点击删除气泡
</script>