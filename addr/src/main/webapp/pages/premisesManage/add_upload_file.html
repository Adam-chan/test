<div class="row" style="padding:0 25px">
	<input id="premisesId" value="${premisesId!}" type="hidden">
	<div class=" col-xs-12">
		<label for="" class="col-xs-4 control-label">已选择的文件：</label>
		<div class=" col-xs-2">
		<form id="form" enctype="multipart/form-data">
		<a href="javascript:void(0);"
			style="position: relative;overflow: hidden;display: block;width: 95px;float: right;height: 50px;color:#0196ff;">
			<input onchange="fileUpload();" name="pic" type="file"
			style="position: absolute;top: -6px;left: -74px;opacity: 0;border: 0;width: 340px;height: 70px!important;line-height: 70px!important; cursor: pointer;" />
			<button>上传文件</button>
		</a>

	</form>
		</div>
	</div>
	<div class="blueTags col-xs-12">
		<div class='tags col-xs-12' id="fileUploaded" style="border:0;width:100%"></div>
	</div>

</div>
<script type="text/javascript">

	var original = "";
	function fileUpload() {
		var formData = new FormData($("#form")[0]);
		$.ajax({
				url : "${UPLOAD_URL}/save.do",
				type : "POST",
				data : formData,
				dataType : "JSON",
				async : false,
				processData : false,
				contentType : false,
				success : function(data) {
					$("#fileUploaded").append('<span class="tag dataFiles" data-original="'+data.original+'" data-folderName="'+data.folderName+'" data-fileName="'+data.fileName+'" >'+data.original+'<button type="button" class="close" onclick="closeSpan(this);">×</button></span>');
				},
				error : function(data) {
					alert("上传失败");
				}
			});
	}

	//保存下载资料
	function saveUploadFile() {
		var dataStr = "[";
		var list = $("#fileUploaded").find(".dataFiles");
		list.each(function (i){
			var folderName = $(this).attr("data-folderName");
			var fileName = $(this).attr("data-fileName");
			var original = $(this).attr("data-original");
			dataStr+='{"folderName":"'+folderName+'","fileNameLong":"'+fileName+'","fileName":"'+original+'"}';
			if(i != list.length -1){
				dataStr+= ',';
			}
		});
		dataStr +="]";
		var url = "${CTX}/premisesDetail/saveUploadFile.do";
		$.ajax({
			type : "POST",
			url : url,
			async : false,
			dataType : "JSON",
			data : {
				"premisesId" : $("#premisesId").val(),
				"fileName" : original,
				"dataStr":dataStr

			},
			success : function(data) {
				if (data >= 1) {
					alert("操作成功");
				} else {
					alert("操作失败");
				}
			}
		});
	}

	function closeSpan(obj) {
		$(obj).parent().remove();
	}//点击删除气泡
</script>