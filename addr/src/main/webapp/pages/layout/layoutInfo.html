<div class="tableContent" style="height:680px;">

	<div class="row">
		<div class="col-xs-9" style="padding:5px;width:1200px;">
			<form action="" class="searchForm">
				<input id="layoutName" type="hidden" />
				<!-- 导航树点击改变value -->
			</form>
			<input name="premisesId" id="premisesId" value="${premisesId!''}"
				type="hidden" />
			<!-- 页面传值用 -->
			<div class="row">
				<div class="col-xs-2">
					<div class="col-xs-12" id="tree" style="text-align:center;">
						<p class="layoutMenu" id="">全部户型</p>
					<#list layoutNameList as item>
						<p class="layoutMenu" id="${(item.layoutName)!''}">${(item.layoutName)!''}</p>
					</#list>
					</div>
				</div>
				<div class="col-xs-8" style=" height:400px;">
					<div id="" style="background-color:#e5e9eb; height:30px;">
						<span style="font-weight:bold;">小区户型信息</span>
						<button class="btn btn-xs btn-icon btn-blue" style="float:right;"
							onclick="toAddLayout();">
							<span>+添加户型</span>
						</button>
					</div>
					<div class="dataList" style="height:500px;">
						<div class="col-xs-3 layout example" style="display:none;text-align:center;">
							<div class="row">
								<img class="layoutImg" /> 
							</div>
							<div class="row">
								<b style="display:block;text-align:center;bold" lang="layoutName"></b>
							</div>
							<div class="row">
								<span lang="room" style="float:left;"></span> <span
									style="float:left;">室</span> <span lang="office"
									style="float:left;"></span> <span style="float:left;">厅</span>
								<span lang="wc" style="float:left;"></span> <span
									style="float:left;">卫</span> <span lang="balcony"
									style="float:left;"></span> <span style="float:left;">厨</span>
								<span style="float:right;">㎡</span> <span lang="coveredArea"
									style="float:right;"></span><br>
							</div>
							<div class="row">
								<span lang="unitPrice" style="float:left;"></span> 
								<span style="float:left;">元/㎡</span> 
								<span style="float:right;">元</span>
								<span lang="totalPrice" style="float:right;"></span>
								</div>
							<div class="row">
								<div style="display:block">
									<button class="btn btn-xs btn-icon btn-blue modify">
										<span>修改</span>
									</button>
									<button class="btn btn-xs btn-icon btn-blue delete">
										<span>删除</span>
									</button>
								</div>
							</div>
						</div>
					</div>
					<br>
					<br>
					<br>
					<br>
					<div class="pagination" style="display:block;text-align:center;"></div>
				</div>
			</div>
		</div>
	</div>
</div>

<style type="text/css">
.layoutMenu:hover {
	cursor: pointer;
	text-decoration: underline
}

.layout {
	border: 1px solid #757575;
	margin: 5px;
	padding: 15px;
	width: 180px;
}

.layoutImg {
	width: 160px;
	height: 160px;
	text-align: center;
}

ul {
	list-style: none;
	margin-left: 20px;
}

ul li:hover {
	cursor: pointer;
}
</style>

<script type="text/javascript">
	$(function() {
		layoutListInit();
	});
	function layoutListInit() {
		var opts = new PtsObject();
		opts.dataList = ".dataList";
		opts.searchForm = ".searchForm";
		opts.pagination = ".pagination";
		opts.example = "example";
		opts.showCount = 8;
		opts.formAction = "${CTX}/layoutInfo/getLayoutListByPremisesId.do?premisesId="
				+ $("#premisesId").val() + "&layoutName=" + $("#layoutName").val();
		opts.detailFunction = function(obj, data) {
			obj.find("img").attr("src",
					"${IMAGE_URL}" + data.folderName + "/" + data.fileName);

			obj.find(".delete").click(function() {
				if (confirm("确认删除？")) {
					$.ajax({
						url : "${CTX}/layoutInfo/deleteLayoutById.do",
						dataType : "json",
						data : {
							id : data.id
						},
						success : function(data) {
							alert("删除成功！");
							GDPaging.initDataList(opts);
						}
					});
				}
			});
			obj.find(".modify").click(function() {
				toUpdateLayout(data.id);
			});
		}
		GDPaging.initDataList(opts);
	}

	/* 添加户型页面 */
	function toAddLayout() {
		oaDialogOpen("addLayout",//对话框ID，必填，且不能与当前页面的ID重复
		{
			url : "${CTX}/layoutInfo/toAddLayout.do?premisesId="
					+ $("#premisesId").val(),//调用页面的url
			title : "添加户型",//弹框的title
			closeOnEscpe : true,//是否通过escpe关闭弹框
			closeBtn : true,//是否显示关闭按钮
			width : 750,//弹框的宽度
			height : 400,
			buttons : {
				"确定" : function() {
					if($("#img").attr("src")==""){
						alert("请上传户型图");
						return;
					}else{
						saveLayout(1);
						$(this).dialog("close");
						layoutListInit();
					}
				},
				"取消" : function() {
					$(this).dialog("close");
				}
			},
			openCall : function() {
			},//弹框打开后的回调函数
			closeCall : function() {
			}//弹框关闭后的回调函数
		});
	}

	/* 修改户型页面 */
	function toUpdateLayout(id) {
		oaDialogOpen("updateLayout",//对话框ID，必填，且不能与当前页面的ID重复
		{
			url : "${CTX}/layoutInfo/toUpdateLayout.do?id=" + id,//调用页面的url
			title : "修改户型",//弹框的title
			closeOnEscpe : true,//是否通过escpe关闭弹框
			closeBtn : true,//是否显示关闭按钮
			width : 800,//弹框的宽度
			height : 400,
			buttons : {
				"确定" : function() {
					saveLayout(2);
					$(this).dialog("close");
					layoutListInit();
				},
				"取消" : function() {
					$(this).dialog("close");
				}
			},
			openCall : function() {
			},//弹框打开后的回调函数
			closeCall : function() {
			}//弹框关闭后的回调函数
		});
	}

	$(".layoutMenu").each(function() {
		$(this).click(function() {
			$("#layoutName").val($(this).attr("id"));
			layoutListInit();
		});
	});
</script>
