
<form action="" id="saveForm">
	<input type="hidden" name="premisesId"  value="${premisesId!}"/>
	<table id="table2" class="table table-striped table-bordered">
			<tr>
				<td>栋座信息:</td>
			</tr>
			<tr>
				<td>
					<div class="container-fuild">
						<div class="row">
							<div class="col-sm-7 col-md-7 col-lg-7">
								<div class="row">
									<div class="col-sm-4 col-md-4 col-lg-4">
										&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;区域：
										<select name="areaId" id="Area" class="province input-xs isFlag" required data-value="请选择市" >
											<option  value="">请选择</option>
											<#list AreaList as item>
												<#if eareId??>
														<#if item.id == eareId> 
					 										<option selected="selected"  value="${item.id!}">${item.name!}</option>
														<#else> 
															<option value="${item.id!}">${item.name!}</option>
														</#if>
													<#else>
														<option value="${item.id!}">${item.name!}</option>
												</#if>	
											</#list>
										</select>
										<span style="color:red"> *</span>
									</div>
									<div class="col-sm-4 col-md-4 col-lg-4">
										房屋用途：
										<select name="purpose" id="purpose2" class="province input-xs  isFlag" >
											<option selected="selected" value="" >请选择</option>
											<#if basePremises.purpose??>
													<#if basePremises.purpose  == 1>
															<option selected="selected" value="1">住宅</option>
														<#else>
															<option value="1">住宅</option>
													</#if>
													<#if basePremises.purpose  == 2>
															<option selected="selected" value="2">商铺</option>
														<#else>
															<option value="2">商铺</option>
													</#if>
													<#if basePremises.purpose  == 3>
															<option selected="selected" value="3">写字楼</option>
														<#else>
															<option value="3">写字楼</option>
													</#if>
													<#if basePremises.purpose  == 4>
															<option selected="selected" value="4">商住两用</option>
														<#else>
															<option value="4">商住两用</option>
													</#if>
												<#else>
														<option value="1">住宅</option>
														<option  value="2">商铺</option>
														<option value="3">写字楼</option>
														<option value="4">商住两用</option>
											</#if>
										
											
											
										</select>
								</div>
								<div class="col-sm-4 col-md-4 col-lg-4">
									建筑年代：
									<select name="buildingYear" id="buildingYear2" class="province input-xs  isFlag" >
										<option selected="selected" value="">请选择</option>
									</select>
								</div>
							</div>
						</div>
						
						<div class="col-sm-5 col-md-5 col-lg-5">
							<div class="row">
								<div class="col-sm-6 col-md-6 col-lg-6">
									建筑结构：
									<select name="buildingConst" id="buildingConst2" class="province input-xs province isFlag">
										<option selected="selected" value="">请选择</option>
										<#if basePremises.buildingStructure??>
												<#if basePremises.buildingStructure  ==1>
												<option  selected="selected" value="1">框架结构</option>
												<#else>
												<option   value="1">框架结构</option>
												</#if>
												<#if basePremises.buildingStructure  ==2>
														<option selected="selected"  value="2">剪力结构</option>
													<#else>
														<option   value="2">剪力结构</option>
												</#if>
												<#if basePremises.buildingStructure  ==3>
															<option  selected="selected" value="3">框架-剪力结构</option>
													<#else>
														<option   value="3">框架-剪力结构</option>
												</#if>
												<#if basePremises.buildingStructure  ==4>
														<option selected="selected"  value="4">筒体结构</option>
													<#else>
														<option   value="4">筒体结构</option>
												</#if>
												<#if basePremises.buildingStructure  ==5>
														<option selected="selected"  value="5">筒中筒结构</option>
													<#else>
														<option   value="5">筒中筒结构</option>
												</#if>
												<#if basePremises.buildingStructure  ==6>
														<option selected="selected"  value="6">砖混结构</option>
													<#else>
														<option   value="6">砖混结构</option>
												</#if>
												<#if basePremises.buildingStructure  ==7>
														<option selected="selected"  value="7">板柱结构</option>
													<#else>
														<option   value="7">板柱结构</option>
												</#if>
												<#if basePremises.buildingStructure  ==8>
														<option selected="selected"  value="8">砌体结构</option>
													<#else>
														<option   value="8">砌体结构</option>
												</#if>
												<#if basePremises.buildingStructure  ==9>
														<option selected="selected"  value="9">钢筋混凝土结构</option>
													<#else>
														<option   value="9">钢筋混凝土结构</option>
												</#if>
												<#if basePremises.buildingStructure  ==10>
														<option selected="selected"  value="10">钢结构</option>
													<#else>
														<option   value="10">钢结构</option>
												</#if>
												<#if basePremises.buildingStructure  ==11>
														<option selected="selected"  value="11">木结构</option>
													<#else>
														<option   value="11">木结构</option>
												</#if>
											<#else>
												<option   value="1">框架结构</option>
												<option   value="2">剪力结构</option>
												<option   value="3">框架剪力结构</option>
												<option   value="4">筒体结构</option>
												<option   value="5">筒中筒结构</option>
												<option   value="6">砖混结构</option>
												<option   value="7">板柱结构</option>
												<option   value="8">砌体结构</option>
												<option   value="9">钢筋混凝土结构</option>
												<option   value="10">钢结构</option>
												<option   value="11">木结构</option>
										</#if>
									</select>
								</div>
								<div class="col-sm-6 col-md-6 col-lg-6">
									建筑类型：
									<select name="buildingType" id="buildingType2" class="province input-xs province isFlag">
										<option selected="selected" value="">请选择</option>
										<#if basePremises.buildingType??>
												<#if basePremises.buildingType  ==1>
													<option  selected="selected" value="1">超高层（40层以上）</option>
												<#else>
													<option   value="1">超高层（40层以上）</option>
												</#if>
												<#if basePremises.buildingType  ==2>
														<option selected="selected"  value="2">高层（10层以上）</option>
													<#else>
														<option   value="2">高层（10层以上）</option>
												</#if>
												<#if basePremises.buildingType  ==3>
															<option  selected="selected" value="3">小高层（8-11层）</option>
													<#else>
														<option   value="3">小高层（8-11层）</option>
												</#if>
												<#if basePremises.buildingType  ==4>
														<option selected="selected"  value="4">中高层（7-9层）</option>
													<#else>
														<option   value="4">中高层（7-9层）</option>
												</#if>
												<#if basePremises.buildingType  ==5>
														<option selected="selected"  value="5">底层（1-3层）</option>
													<#else>
														<option   value="5">底层（1-3层）</option>
												</#if>
												<#if basePremises.buildingType  ==6>
														<option selected="selected"  value="6">多层复式</option>
													<#else>
														<option   value="6">多层复式</option>
												</#if>
												<#if basePremises.buildingType  ==7>
														<option selected="selected"  value="7">高层复式</option>
													<#else>
														<option   value="7">高层复式</option>
												</#if>
												<#if basePremises.buildingType  ==8>
														<option selected="selected"  value="8">多层跃式</option>
													<#else>
														<option   value="8">多层跃式</option>
												</#if>
												<#if basePremises.buildingType  ==9>
														<option selected="selected"  value="9">高层跃式</option>
													<#else>
														<option   value="9">高层跃式</option>
												</#if>
												<#if basePremises.buildingType  ==10>
														<option selected="selected"  value="10">空中别墅</option>
													<#else>
														<option   value="10">空中别墅</option>
												</#if>
												<#if basePremises.buildingType  ==11>
														<option selected="selected"  value="11">独栋别墅</option>
													<#else>
														<option   value="11">独栋别墅</option>
												</#if>
												<#if basePremises.buildingType  ==12>
														<option selected="selected"  value="12">联排别墅</option>
													<#else>
														<option   value="12">联排别墅</option>
												</#if>
												<#if basePremises.buildingType  ==13>
														<option selected="selected"  value="13">双拼别墅</option>
													<#else>
														<option   value="13">双拼别墅</option>
												</#if>
												<#if basePremises.buildingType  ==14>
														<option selected="selected"  value="14">叠拼别墅</option>
													<#else>
														<option   value="14">叠拼别墅</option>
												</#if>
												<#if basePremises.buildingType  ==15>
														<option selected="selected"  value="15">花园洋房</option>
													<#else>
														<option   value="15">花园洋房</option>
												</#if>
												<#if basePremises.buildingType  ==16>
														<option selected="selected"  value="16">其他</option>
													<#else>
														<option   value="16">其他</option>
												</#if>
											<#else>
												<option   value="1">超高层（40层以上）</option>
												<option   value="2">高层（10层以上）</option>
												<option   value="3">小高层（8-11层）</option>
												<option   value="4">中高层（7-9层）</option>
												<option   value="5">底层（1-3层）</option>
												<option   value="6">多层复式</option>
												<option   value="7">高层复式</option>
												<option   value="8">多层跃式</option>
												<option   value="9">高层跃式</option>
												<option   value="10">空中别墅</option>
												<option   value="11">独栋别墅</option>
												<option   value="12">联排别墅</option>
												<option   value="13">双拼别墅</option>
												<option   value="14">叠拼别墅</option>
												<option   value="15">花园洋房</option>
												<option   value="16">其他</option>
										</#if>
										
									</select>
									</div>
								</div>
							</div>
							
						</div>
					</div>
				</td>
			</tr>
			
			<tr>
				<td>
					<div class="container-fuild">
						<div class="row">
						
							<div class="col-sm-6 col-md-6 col-lg-6">
								<div class="row">
									<div class="col-sm-6 col-md-6 col-lg-5">
											楼栋分组：
											<select name="buildingGroupId" id="buildingGroupId2" class="province input-xs isFlag">
												<option  selected="selected" value="">请选择</option>
												<#if groupList??>
													<#list groupList as item>
																<option value="${item.id!}">${item.groupName!}</option>
													</#list>
												</#if>	
											</select>
									</div>
									<div class="col-sm-4 col-md-4 col-lg-4">
										<div id="houseNum1Chack">
											栋座数：
											<input name="houseNum" id="houseNum2" type="text" class="isFlag validate" number="true"  readonly="readonly"/>
											</div>
									</div>
								</div>
							</div>
							
							<div class="col-sm-6 col-md-6 col-lg-6">
								<div class="row houseCodeType">
									栋座编号类型：&nbsp;&nbsp;
									<label><input name="houseCodeType"  class="buildingCode" value="2" type="radio"  checked="checked"  />&nbsp;阿拉伯数字编号&nbsp;&nbsp;&nbsp;</label>
									<label><input name="houseCodeType"  class="buildingCode" value="1" type="radio" />&nbsp;字母编号&nbsp;&nbsp;&nbsp;</label>
								</div>
							</div>
							
						</div>
					</div>
				</td>
			</tr>
			<tr>
				<td>
					<div class="container-fuild">
						<div class="row">
						
							<div class="col-sm-7 col-md-7 col-lg-7">
								<div class="row">
									<div class="col-sm-4 col-md-4 col-lg-4">
										栋座前缀：
										<input name="housePre" name="housePre2" type="text"  maxlength="12" class="isFlag"/>
									</div>
									<div class="col-sm-4 col-md-4 col-lg-4">
										栋座后缀：
										<input name="houseSuf" name="houseSuf2" type="text" maxlength="12" class="isFlag"/>
									</div>
									<div class="col-sm-4 col-md-4 col-lg-4">
									<div id="numStart2Chack">
										号段起始：
										<input name="numStart" id="numStart2" type="text" class="isFlag"  maxlength="5" required onblur="aihome.num()"/><span style="color:red"> *</span>
									</div>
									</div>
							</div>
						</div>
						
						<div class="col-sm-5 col-md-5 col-lg-5">
							<div class="row">
								<div class="col-sm-6 col-md-6 col-lg-6">
									号段终止：
									<input name="numEnd"  id="numEnd2" type="text" class="isFlag" required="required"  maxlength="5" onblur="aihome.num()"/><span style="color:red"> *</span>
								</div>
								<div class="col-sm-6 col-md-6 col-lg-6">
									房屋性质：	
									<select name="propertyNature" id="propertyNature2" class="province input-xs isFlag">
										<option value="" selected="selected" value="">请选择</option>
										<option   value="1">已购公房</option>
										<option   value="2">商品房</option>
										<option   value="3">空置房</option>
										<option   value="4">使用权房</option>
										<option   value="5">经济使用房</option>
									</select>
									</div>
								</div>
							</div>
							
						</div>
					</div>
				</td>
			</tr>
			
			<tr>
				<td>
					<div class="container-fuild">
						<div class="row">
						
							<div class="col-sm-6 col-md-6 col-lg-6">
								<div class="row">
									<div class="col-sm-5 col-md-5 col-lg-5">
										是否有物业公司：
											<#if basePremises.hasPropertyManagementCompany??>
													<label><input name="costType" <#if basePremises.hasPropertyManagementCompany == 1>checked="checked"</#if> id="costType2Y" value="1" type="radio" />是&nbsp;</label>	
													<label><input name="costType" <#if basePremises.hasPropertyManagementCompany == 2>checked="checked"</#if> id="costType" value="2" type="radio" />否&nbsp;</label>
												<#else>
													<label><input name="costType" id="costType2Y" value="1" type="radio" />是&nbsp;</label>	
													<label><input name="costType" id="costType" value="2" type="radio" />否&nbsp;</label>
											</#if>
									</div>
									<div id="costType1" class="col-sm-6 col-md-6 col-lg-6" style="display: none">
										物业费：<input name="propertyFee" id="propertyFee1" value="${basePremises.propertyFee!}" maxlength="9" type="text"/>元/月/平
									</div>
									<div id="costType2" class="col-sm-6 col-md-6 col-lg-6" style="display: none">
										清洁费：<input name="propertyFee" id="propertyFee2" value="${basePremises.cleaningFee!}" maxlength="9" type="text"/>元/月/平
									</div>
								</div>
							</div>
							
						</div>
						<br>
		
				
					</div>
				</td>
			</tr>
			<tr>
				<td>
			<div class="container-fuild">
			<div class="row">
							<div class="col-sm-12 col-md-12 col-lg-12">
								<div class="row">
									<div class="col-sm-12 col-md-12 col-lg-12 " >
										<label >教育设施：</label>
										<#if eduList??>
											<#list eduList as item>
											<label><input name="eduId" name="eduId" value="${item.EDUID}" type="checkbox" />&nbsp;${item.EDUNAME}&nbsp;</label>
											</#list>
										</#if>
									</div>
								</div>
							</div>
							
						</div>
		
						<br>
		
				
					</div>
				</td>
			</tr>
			
			
	</table>
</form>

<style type="text/css">
.isFlag{width: 100px;}
</style>
<script type="text/javascript">

aihome.validateFunction=function(){
	 $.validator.addMethod("englishVerification",function(value,element,params){
			return this.optional(element) || /^[A-Za-z]*$/.test(value);
		},"必须为英文");
	 return $("#saveForm").validate({
			onfocusout: function(element) { $(element).valid(); },  
			rules:{  
			},
			messages:{
				houseNum:{       
					required:"不能为空",
					number:"必须为数字",
				},
				numEnd:{       
					required:"不能为空",
					number:"必须为数字",
				},numStart:{       
					required:"不能为空",
					number:"必须为数字",
				},areaId:{       
					required:"不能为空",
				},
			},
	        errorPlacement: function(error, element){
	            error.appendTo(element.parent());
	        }
		}); 
	
}
//计算楼数
var buildingNum = -1; 
aihome.num = function(){
	var charArrs = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
	var num = 0;debugger
	if($("#numEnd2").val()!="" && $("#numStart2").val()!=""){
		if(!isNaN($("#numEnd2").val())){
			if($("#numEnd2").val()!=$("#numStart2").val()){
				num =($("#numEnd2").val()-$("#numStart2").val())+1;
				if(num>-0){
					var num1 = $("#houseNum2").val(num);
				}else{
					num1 = $("#houseNum2").val("");
					$("#numStart2").val("");
				}
			}else if($("#numEnd2").val() == $("#numStart2").val()){
				num =1;
				var num1 = $("#houseNum2").val(num);
			}
		}else{
			var End = charArrs.indexOf($("#numEnd2").val().toUpperCase());
			var Start=  charArrs.indexOf($("#numStart2").val().toUpperCase());
			if(End == Start){
				num =1;
				$("#houseNum2").val(num);
			}else{
				num = (parseInt(End)-parseInt(Start))+1;
				if(num>0){
					$("#houseNum2").val(num);
				}else{
					$("#numStart2").val("");
					 $("#houseNum2").val("");
				}
			}
		}
	}
}
//添加
aihome.saveBaseBuilding=function(){
	var type = 0;
	if(!aihome.validateFunction().form()) {
		return type;
	}
	var eduIds = [];
	$("input[name ='eduId']").each(function(){
		eduIds.push($(this).val());
	  });
	var eduid = eduIds.join(",");
	// 获取表单
	var oForm = $('#saveForm');
	var saveForm = oForm.result();
	saveForm = $.extend(false,saveForm,{eduId:eduid});
	$.ajax({
	       type : "POST",
	       url : '${CTX}/baseBuilding/saveBuilding.do',
	       dataType : 'json',
	       data : saveForm,
	       async:false,
	       success : function(data) {
	    	   	type= data;
	    		if(type == -1){
					alert("楼栋名称存在");
	    		}else if(type>0){
	    			alert("添加成功")
	    		}
	      }
	   });
	return type;
}
 $(function(){
		//建筑年代下拉赋值
		var myDate= new Date(); 
		var startYear=myDate.getFullYear()-65;//起始年份 
		var endYear=myDate.getFullYear()+65;//结束年份 
		var obj=document.getElementById('buildingYear2');
		<#if basePremises.buildingAge??> 
			var age = ${basePremises.buildingAge};
		<#else>
			var age = "";
		</#if>
		
		for (var i=startYear;i<=endYear;i++) 
		{ 
			obj.options.add(new Option(i,i)); 
		}
		if(age!=""){
			$("#buildingYear2").val(age);
		}else{
			obj.options[obj.options.length-66].selected=1;
		}
		$("#houseNum2").click(function(){
			$("#houseNum2").next().remove();
		});
		//校验
		aihome.validateFunction();
		//判断楼盘是否带物业公司
		if($("#costType2Y").attr("checked")=="checked"){
			 $("#costType1").css("display","block");
		}
		if($("#costType2Y").attr("checked")=="checked"){
			 $("#costType1").css("display","block");
		}
		// 选择物业公司切换div
	  $("input[name='costType']").click(function(){
	 	 if($(this).val()==1){
	 		$("#costType2").css("display","none");
	 		 $("#costType1").css("display","block");
	 	 }else{
	 		 $("#costType1").css("display","none");
	 		 $("#costType2").css("display","block");
	 	 }
	  });
		//楼栋编号类型限制
		 if($("input[name='houseCodeType']:checked").val()==2){
			 $("#numStart2").attr("number","true");
			 $("#numEnd2").attr("number","true");
		}else{
			
			$("#numStart2").attr("englishVerification","true");
			 $("#numEnd2").attr("englishVerification","true");
		}
		$(".buildingCode").click(function(){
			 if($("input[name='houseCodeType']:checked").val()==2){
				 $("#numStart2").removeAttr("englishVerification");
				 $("#numEnd2").removeAttr("englishVerification")
				 $("#numStart2-error").remove();
				 $("#numEnd2-error").remove();
				 $("#numStart2").val("");
				 $("#numEnd2").val("");
				 $("#numStart2").attr("number","true");
				 $("#numEnd2").attr("number","true");
				 $("#numStart2").attr("maxlength","5");
				 $("#numEnd2").attr("maxlength","5");
			}else{
				 $("#numStart2").removeAttr("number");
				 $("#numEnd2").removeAttr("number")
				  $("#numStart2").val("");
				 $("#numEnd2").val("");
				 $("#numStart2-error").remove();
				 $("#numEnd2-error").remove();
				 $("#numStart2").attr("englishVerification","true");
				 $("#numEnd2").attr("englishVerification","true");
				 $("#numStart2").attr("maxlength","1");
				 $("#numEnd2").attr("maxlength","1");
			}
	  });
 });
</script>
