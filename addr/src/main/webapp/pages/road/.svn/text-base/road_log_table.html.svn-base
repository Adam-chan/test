<div class="tableContent" >
 	<div class="row">
 			<div class="col-md-3 col-sm-3 col-xs-3">
           <div class="form-xs form-group row ">
	          <label for="addClass" class="col-md-4 col-sm-4 col-xs-4 control-label">撒号区域：</label>
	          <div class="col-md-8 col-sm-8 col-xs-8">
	           	<select  class="city input-xs form-control searchKey" id="handOutNum">
					<option value="" selected="selected">请选择撒号区域</option>
					<#list provinceList as item>
						<option value="${item.id!}">${item.name!}</option>
					</#list>
				</select>
	          </div>
	        </div>
	    </div>
	    <div class="col-md-3 col-sm-3 col-xs-3">
           <div class="form-xs form-group row">
	          <label for="addClass" class=" col-md-4 col-sm-4 col-xs-4 control-label">道路名称：</label>
	          <div class="col-md-8 col-sm-8 col-xs-8 ">
               	<input type="hidden" id="keyWordName" name="keyWordName" value ="" />
               	<input class="col-md-8 col-sm-8 col-xs-8 selectInput searchKey " type="text" id="keyWord" placeholder="输入道路名称" value="">
	          </div>
	        </div>
	    </div>
	    <div class="col-xs-12 roadChange">
		    <table id="roadLog_jqGrid">
		    
			</table>
		<div id="jqGridPager"></div>
    	</div>
  </div> 
</div>
<input type=hidden id="tableType" value="${type!}" ></input>   
<script type="text/javascript">
var rod_table = {};
$(function (){
	init_jqGrid();
	 /* 查询 */
	$("#road_query").unbind().click(function(){
		var param = getSearchParam();
		var url="${CTX}/road/queryRoadLogListPage.do?"+param;
		$("#roadLog_jqGrid").setGridParam({url:url,page:1}).trigger('reloadGrid');
	});
	 if($("#tableType").val()==1){
		 $("#top_tools").children().first().siblings().hide();
	 };
	
});
function init_jqGrid(){
	$("#roadLog_jqGrid").jqGrid({
		 url: '${CTX}/road/queryRoadLogListPage.do', 
         datatype: "json",
         colModel: [
             { label: '撒号区域', name: 'areaName',index:'name',sortable : true,width: 30 },
             { label: '道路名称', name: 'roadName',index:'name',sortable : true,width: 30 },
             { label: '起始号段', name: 'startNum',index:'name',sortable : true,width: 30 },
             { label: '结束号段', name: 'endNum',index:'name',sortable : true,width: 30 },
             { label: '生成规则', name: 'creatTypeStr',index:'name',sortable : true,width: 30 },
             { label: '生成规则', name: 'creatType',index:'name',sortable : true,width: 30, hidden:true},
             { label: '忽略号段', name: 'ignoreNum',index:'name',sortable : true,width: 30 },
             { label: '操作人', name: 'operator',index:'name',sortable : true,width: 30 },
             { label: '操作时间', name: 'operTimeStr',index:'name',sortable : true,width: 30},
             { label: '使用状态', name: 'statusStr',index:'name',sortable : true,width: 30},
             { label: '使用状态', name: 'status',index:'name',sortable : true,width: 30, hidden:true}
         ],
         multiselect: true,
         multiboxonly: true,
         onSelectRow: function (rowId, status, e) {
         	 rowDataNames = [];
             var rowIds = $("#roadLog_jqGrid").jqGrid('getGridParam', 'selarrrow');
             $(rowIds).each(function(i,rowId){
                 rowDataNames.push($("#roadLog_jqGrid").jqGrid('getRowData',rowId));
             });
         },
         viewrecords: true,
         autowidth:true,
         height: $(window).height()-300,
         rowNum:30,
	     rowList:[10,20,30,50,100],
         pager: "#jqGridPager",
     	 jsonReader: { root: 'pagerResults', page:'currentPage',rows:'rowCount',total:'pageCount',records:'totalCount',repeatitems: false} 
    });
}
//更改道路日志使用状态
function updateRoadLogStatus(id,type){
	var useStatus ;
	if(type==1){
		useStatus = 2;
	}else{
		useStatus = 1;
	}
	$.ajax({
		url : "${CTX}/road/updateRoadLogStatus.do",
		dataType : "json",
		type : 'post',
		data : {"roadLogStatus":useStatus,"id":id},
		success : function(data) {
			if(data!=0){
				$("#roadLog_jqGrid").trigger("reloadGrid");
			}
		}
	});
}
/* 模糊搜索*/
$("#keyWord").autocomplete({
	source : function(request, response) {
		$.ajax({
			url : "${CTX}/road/getAordListByMatch.do",
			dataType : "json",
			type : 'post',
			data : {
				matchStr : request.term
			},
			success : function(data) {
				var array = new Array(data.length);
				for (var i = 0; i < data.length; i++) {
					var temp = {
						key : data[i].id,
						value : data[i].roadName
					};
					array[i] = temp;
				}
				response(array);
			}
		});
	},
	select : function(event, ui) {
		$("#keyWordName").val(ui.item.key);
		$("#keyWord").val(ui.item.value);
		event.preventDefault();
	}
});

</script> 