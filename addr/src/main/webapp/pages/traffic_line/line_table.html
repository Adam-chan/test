<div class="tableContent" >
 	<div class="row">
 		<div class=" col-md-3 col-sm-6">
	        <div class=" form-xs form-group row">
	          <label for="addClass" class="col-md-3 col-sm-6 control-label">线路名称</label>
	          <div class="col-md-8">
	          		<input class="searchKey" type="hidden" id="lineId" value ="" />
	          		<input class="col-md-12 selectInput" type="text" id="line_input" placeholder="线路名称" value="">
		      </div>
	        </div>
	    </div>
	    <div class="col-xs-12">
		    <table id="line_jqGrid">
				
			</table>
		 	<div id="jqGridPager"></div>
        </div>
    </div> 
</div>  

<script type="text/javascript">
	
	$(function (){
		init_jqGrid();
	});
	
	function init_jqGrid(){
		$("#line_jqGrid").jqGrid({
			 url: "${CTX}/aroundLine/getLineListForPage.do?trafficType="+getSelTabIndex(), 
	         datatype: "json",
	         colModel: [
				 { label: 'id', name: 'id',index:'id',hidden:true},
	             { label: '线路名称', name: 'lineName',index:'lineName',width: 30 },
	             { label: '起始站', name: 'startStation',index:'startStation',width: 30 },
	             { label: '终点站', name: 'endStation',index:'endStation',width: 30 },
	             { label: '首班时间', name: 'firstTime',index:'firstTime',width: 30 },
	             { label: '末班时间', name: 'lastTime',index:'lastTime',width: 30 ,
	             	 formatter:function(rowName, options, rowObject){
	            	     if(rowName){
	            	    	 if(rowName=="0:00"){
	            	    		 return "24:00(0:00)";
	            	    	 }else{
	            	    		 return rowName;
	            	    	 }
	            	     }else{
	            	    	 return "";
	            	     }
		             }	 
	             },
	             { label: '最低票价', name: 'ticketPrice',index:'ticketPrice',width: 30 },
	             { label: '备注', name: 'remark',index:'remark',width: 30 }
	         ],
	         multiselect: true,
	         multiboxonly: true,
	         onSelectRow: function (rowId, status, e) {
	         	 rowDataNames = [];
	             var rowIds = $("#line_jqGrid").jqGrid('getGridParam', 'selarrrow');
	             $(rowIds).each(function(i,rowId){
	                 rowDataNames.push($("#line_jqGrid").jqGrid('getRowData',rowId));
	             });
	         },
	         viewrecords: true, 
	         autowidth:true,
	         height: $(window).height()-300,
	         rowNum:30, 
		     rowList:[10,20,30,50,100],
	         pager: "#jqGridPager",
	     	 jsonReader: { root: 'pagerResults', page:'currentPage',rows:'rowCount',total:'pageCount',records:'totalCount',repeatitems: false} 
	    });
	}
	
	$("#line_input").autocomplete({
		source : function(request, response) {
			var selTabIndex = getSelTabIndex();
			$.ajax({
				url : "${CTX}/aroundLine/getLineListByMatch.do",
				dataType : "json",
				type : 'post',
				data : {
					matchStr : request.term,
					trafficType : selTabIndex
				},
				success : function(data) {
					var array = new Array(data.length);
					for (var i = 0; i < data.length; i++) {
						var temp = {
							key : data[i].id,
							value : data[i].lineName
						};
						array[i] = temp;
					}
					response(array);
				}
			});
		},
		select : function(event, ui) {
			$("#lineId").val(ui.item.key);
			$("#line_input").val(ui.item.value);
			event.preventDefault();
		}
	}); 
	
	$("#line_input").blur(function(){
		if($("#line_input").val()==""){
			$("#lineId").val("");
		}
	});
</script> 
<style>
	.ui-jqgrid tr.jqgrow td {text-overflow : ellipsis;}
</style>