<div id="commonSearch">
	<div id="commonSearchTop" style="font-size: 16px; text-align: center;">
		<div>
			<a id="addCollect" onclick="aihome.addCollect();">收藏</a>
			<a id="deleteCollect" onclick="aihome.deleteCollect();">取消收藏</a>
		</div>
		<div>
			<a onclick="aihome.openProspect();">实勘</a>
		</div>
		<div>
			<a onclick="aihome.openFollow();">跟进</a>
		</div>
		<div id="spaceSee">
			<a onclick="aihome.openSpaceSee();">空看</a>
		</div>
		<div>
			<a onclick="aihome.openMatchCustomer();">配客</a>
		</div>
		<div>
			<a onclick="">房源纸</a>
		</div>
		<div>
			<a onclick="aihome.openReceiveKey();">收钥匙</a>
		</div>
		<div>
			<a onclick="aihome.openProxyInput();">委托书录入</a>
		</div>
		<div>
			<a onclick="aihome.openProtect();">保护</a>
		</div>
	
		<#if type=='2'>
		<div>
			<a onclick="aihome.openManageRentContract()">签约</a>
		</div>
		<div>
			<a onclick="aihome.openManageRentContract()">委托签约</a>
		</div>
		<#else>
		<div>
			<a onclick="aihome.openIntentionSign();">意向签约</a>
		</div>
		<div>
			<a onclick="aihome.openAgreementSign();">合同签约</a>
		</div>
		</#if>
		<div>
			<a onclick="aihome.openHousingOwnership();">房源归属</a>
		</div>
		<div>
			<a onclick="aihome.openAntiCounterfeiting();">打假</a>
		</div>
	</div>
	<div id="commonSearchBottom" style="font-size: 16px; text-align: center;">
		<div>
			<span>住宅信息：</span>
		</div>
		<div>
			<a onclick="aihome.openTopRecommended();">推荐置顶</a>
		</div>
		<div>
			<a onclick="aihome.openManageTimeLimitExpress()">限时速递</a>
		</div>
		<div>
			<a onclick="">外司已网签</a>
		</div>
		<div>
			<a onclick="aihome.openPropertyCertificate();">录入产权证书</a>
		</div>
		<div>
			<a onclick="aihome.openParking();">关联车位</a>
		</div>
		<div>
			<a onclick="aihome.houseEdit();">修改</a>
		</div>
	</div>
</div>
<script type="text/javascript">
/* 限时速递 */
aihome.openManageTimeLimitExpress = function(){
		//获取高和宽
		var height = $(window).height()*0.7;
		var width = $(window).width()*0.6;
		var title = "限时速递";
		var url="${CTX}/manageTimeLimitExpress/manageTimeLimitIndex.do?houseInfoId="+$("#houseInfoId").val()+"&type="+$("#demandTypeLayout").val();
		var	but = {
			}
		//弹出窗口
		oaDialogOpen("ManageTimeLimitExpress",//对话框ID，必填，且不能与当前页面的ID重复
			{url:url,//目标地址
			title:title,//弹框的title
			closeOnEscpe:true,//是否通过escpe关闭弹框
			closeBtn:true,//是否显示关闭按钮
			width:width,//弹框的宽度
			height:height,
			buttons:but
	 	})
	}
/*普租合同录入  */
aihome.openManageRentContract = function(){
	//获取高和宽
	var height = $(window).height()*0.7;
	var width = $(window).width()*0.6;
	var title = "普租合同录入";
	var url="${CTX}/manageRentContract/manageRentContractIndex.do?houseInfoId="+$("#houseInfoId").val();
	var	but ={
				"保存" : function() {//按钮和执行函数
				 var type = aihome.addManageRentContract();
				 type = -1;
				 if(type<0  || type== false){
						
					}else{
						alert("添加成功！");
						$(this).dialog("close");
					}
				}, 
				"重填" : function() {
					aihome.reset();
				}
		};
	//弹出窗口
	oaDialogOpen("manageRentContract",//对话框ID，必填，且不能与当前页面的ID重复
		{url:url,//目标地址
		title:title,//弹框的title
		closeOnEscpe:true,//是否通过escpe关闭弹框
		closeBtn:true,//是否显示关闭按钮
		width:width,//弹框的宽度
		height:height,
		buttons:but
 	})
}
/* 收藏 */
aihome.addCollect = function() {
	$.ajax({
		url : "${CTX}/commonSearch/addCollect.do",
		dataType : "json",
		data : {
			houseInfoId : $("#houseInfoId").val()
		},
		success : function(data) {
			$("#collectId").val(data);
			$("#addCollect").css("display", "none");
			$("#deleteCollect").css("display", "inline");
			alert("成功收藏房源！");
		}
	});
},
/* 取消收藏 */
aihome.deleteCollect = function() {
	$.ajax({
		url : "${CTX}/commonSearch/deleteCollect.do",
		dataType : "json",
		data : {
			collectId : $("#collectId").val()
		},
		success : function(data) {
			$("#addCollect").css("display", "inline");
			$("#deleteCollect").css("display", "none");
			alert("成功取消收藏房源！");
		}
	});
},
/* 实勘 */
aihome.openProspect = function() {
	oaDialogOpen(
		"openProspect",//对话框ID，必填，且不能与当前页面的ID重复
		{
			url: "${CTX}/commonSearch/openProspect.do?houseInfoId="+$("#houseInfoId").val()+
				"&houseCode="+$("#detailHouseCode").val()+"&coveredArea="+$("#coveredAreaLayout").val()+
				"&rooms="+$("#roomsLayout").val()+"&office="+$("#officeLayout").val()+
				"&kitchen="+$("#kitchenLayout").val()+"&wc="+$("#wcLayout").val(),//调用页面的url
			title: "实勘",//弹框的title
			closeOnEscpe: true,//是否通过esc关闭弹框
			closeBtn: true,//是否显示关闭按钮
			width: $(window).width()*0.5,//弹框的宽度
			height: $(window).height()*0.5,//弹框的高度
			openCall: function() {
			},
			closeCall: function() {
			},			
			buttons: {
				"提交" : function() {
					aihome.submitProspect();
					$(this).dialog("close");
				},
				"取消" : function() {
					$(this).dialog("close");
				}
			}
		}
	)
},
/* 跟进 */
aihome.openFollow = function() {
	oaDialogOpen(
		"openFollow",//对话框ID，必填，且不能与当前页面的ID重复
		{
			url: "${CTX}/commonSearch/openFollow.do?houseInfoId="+$("#houseInfoId").val(),//调用页面的url
			title: "添加跟进",//弹框的title
			closeOnEscpe: true,//是否通过esc关闭弹框
			closeBtn: true,//是否显示关闭按钮
			width: $(window).width()*0.4,//弹框的宽度
			height: $(window).height()*0.35,//弹框的高度
			buttons: {
				"保存" : function() {
					if(aihome.addFollow()) {
						$(this).dialog("close");
					}
				}
			},
			openCall: function() {
				//弹框打开后的回调函数
				$("#openFollow").parent().css("cssText", "position: absolute; width: "+$(window).width()*0.4+"px; height: "+$(window).height()*0.35+"px; left: "+$(window).width()*0.3+"px; top: "+$(window).height()*0.325+"px; display: block; z-index: 1041 !important;");
				$("#openFollow").parent().next().css("cssText", "z-index: 1040 !important;");
			},
			closeCall: function() {
				//弹框关闭后的回调函数
			}
		}
	)
},
/* 空看 */
aihome.openSpaceSee = function() {
	oaDialogOpen(
		"openSpaceSee",//对话框ID，必填，且不能与当前页面的ID重复
		{
			url: "${CTX}/commonSearch/openSpaceSee.do?houseInfoId="+$("#houseInfoId").val(),//调用页面的url
			title: "添加空看",//弹框的title
			closeOnEscpe: true,//是否通过esc关闭弹框
			closeBtn: true,//是否显示关闭按钮
			width: $(window).width()*0.4,//弹框的宽度
			height: $(window).height()*0.35,//弹框的高度
			buttons: {
				"保存" : function() {
					if(aihome.addSpaceSee()) {
						$("#spaceSee").css("display", "none");
						var aWidth = $("#commonSearch").width() / 13;
						$("#commonSearchTop div").css("width", aWidth);
						$("#commonSearchBottom div").css({"display": "inline-block", "width": aWidth});
						$(this).dialog("close");
					}
				}
			},
			openCall: function() {
				//弹框打开后的回调函数
				$("#openSpaceSee").parent().css("cssText", "position: absolute; width: "+$(window).width()*0.4+"px; height: "+$(window).height()*0.35+"px; left: "+$(window).width()*0.3+"px; top: "+$(window).height()*0.325+"px; display: block; z-index: 1041 !important;");
				$("#openSpaceSee").parent().next().css("cssText", "z-index: 1040 !important;");
			},
			closeCall: function() {
				//弹框关闭后的回调函数
			}
		}
	)
},
/* 配客 */
aihome.openMatchCustomer = function() {
	oaDialogOpen(
		"openMatchCustomer",//对话框ID，必填，且不能与当前页面的ID重复
		{
			url: "${CTX}/commonSearch/openMatchCustomer.do?houseInfoId="+$("#houseInfoId").val()+
				"&sellPrice="+$("#sellPriceLayout").val()+"&coveredArea="+$("#coveredAreaLayout").val()+
				"&floorsNum="+$("#floorsNumLayout").val()+"&decoradion="+$("#decoradionLayout").val()+
				"&rooms="+$("#roomsLayout").val()+"&office="+$("#officeLayout").val()+
				"&kitchen="+$("#kitchenLayout").val()+"&wc="+$("#wcLayout").val()+
				"&premisesName="+$("#premisesNameLayout").val()+"&demandType="+$("#demandTypeLayout").val()+
				"&propertyType="+$("#propertyTypeLayout").val(),//调用页面的url
			title: "配客",//弹框的title
			closeOnEscpe: true,//是否通过esc关闭弹框
			closeBtn: true,//是否显示关闭按钮
			width: $(window).width()*0.5,//弹框的宽度
			height: $(window).height()*0.6,//弹框的高度
			openCall: function() {
				//弹框打开后的回调函数
				$("#openMatchCustomer").parent().css("cssText", "position: absolute; width: "+$(window).width()*0.5+"px; height: "+$(window).height()*0.6+"px; left: "+$(window).width()*0.25+"px; top: "+$(window).height()*0.2+"px; display: block; z-index: 1041 !important;");
				$("#openMatchCustomer").parent().next().css("cssText", "z-index: 1040 !important;");
			},
			closeCall: function() {
				//弹框关闭后的回调函数
			}
		}
	)
},
/* 收钥匙 */
aihome.openReceiveKey = function() {
	if($("#keyId").val() != "") {
		alert("已经存在钥匙，不能新增钥匙。");
		return false;
	}
	oaDialogOpen(
		"openReceiveKey",//对话框ID，必填，且不能与当前页面的ID重复
		{
			url: "${CTX}/commonSearch/openReceiveKey.do?houseInfoId="+$("#houseInfoId").val(),//调用页面的url
			title: "收钥匙",//弹框的title
			closeOnEscpe: true,//是否通过esc关闭弹框
			closeBtn: true,//是否显示关闭按钮
			width: $(window).width()*0.4,//弹框的宽度
			height: $(window).height()*0.4,//弹框的高度
			buttons: {
				"保存" : function() {
					var keyId = aihome.addKey();
					if(keyId != "") {
						$("#keyId").val(keyId);
						$(this).dialog("close");
					}
				}
			},
			openCall: function() {
				//弹框打开后的回调函数
				$("#openReceiveKey").parent().css("cssText", "position: absolute; width: "+$(window).width()*0.4+"px; height: "+$(window).height()*0.4+"px; left: "+$(window).width()*0.3+"px; top: "+$(window).height()*0.3+"px; display: block; z-index: 1041 !important;");
				$("#openReceiveKey").parent().next().css("cssText", "z-index: 1040 !important;");
			},
			closeCall: function() {
				//弹框关闭后的回调函数
			}
		}
	)
},
/* 委托书录入 */
aihome.openProxyInput = function() {
	oaDialogOpen(
		"openProxyInput",//对话框ID，必填，且不能与当前页面的ID重复
		{
			url: "${CTX}/commonSearch/openProxyInput.do?houseInfoId="+$("#houseInfoId").val(),//调用页面的url
			title: "委托书录入",//弹框的title
			closeOnEscpe: true,//是否通过esc关闭弹框
			closeBtn: true,//是否显示关闭按钮
			width: $(window).width()*0.4,//弹框的宽度
			height: $(window).height()*0.3,//弹框的高度
			buttons: {
				"撤销" : function() {
					if(aihome.deleteProxyInput()) {
						$(this).dialog("close");
					}
				},
				"保存" : function() {
					if(aihome.addProxyInput()) {
						$(this).dialog("close");
					}
				},
				"取消" : function() {
					$(this).dialog("close");
				}
			},
			openCall: function() {
				//弹框打开后的回调函数
				$("#openProxyInput").parent().css("cssText", "position: absolute; width: "+$(window).width()*0.4+"px; height: "+$(window).height()*0.3+"px; left: "+$(window).width()*0.3+"px; top: "+$(window).height()*0.35+"px; display: block; z-index: 1041 !important;");
				$("#openProxyInput").parent().next().css("cssText", "z-index: 1040 !important;");
			},
			closeCall: function() {
				//弹框关闭后的回调函数
			}
		}
	)
},
/* 保护 */
aihome.openProtect = function() {
	oaDialogOpen(
		"openProtect",//对话框ID，必填，且不能与当前页面的ID重复
		{
			url: "${CTX}/commonSearch/openProtect.do?houseInfoId="+$("#houseInfoId").val(),//调用页面的url
			title: "保护房源",//弹框的title
			closeOnEscpe: true,//是否通过esc关闭弹框
			closeBtn: true,//是否显示关闭按钮
			width: $(window).width()*0.5,//弹框的宽度
			height: $(window).height()*0.6,//弹框的高度
			buttons: {
				"保存" : function() {
					if(aihome.addProtect()) {
						$(this).dialog("close");
					}
				}
			},
			openCall: function() {
				//弹框打开后的回调函数
				$("#openProtect").parent().css("cssText", "position: absolute; width: "+$(window).width()*0.5+"px; height: "+$(window).height()*0.6+"px; left: "+$(window).width()*0.25+"px; top: "+$(window).height()*0.2+"px; display: block; z-index: 1041 !important;");
				$("#openProtect").parent().next().css("cssText", "z-index: 1040 !important;");
			},
			closeCall: function() {
				//弹框关闭后的回调函数
			}
		}
	)
},
/* 意向签约 */
aihome.openIntentionSign = function() {
},
/* 合同签约 */
aihome.openAgreementSign = function() {
},
/* 房源归属 */
aihome.openHousingOwnership = function() {
	oaDialogOpen(
		"openOwner",//对话框ID，必填，且不能与当前页面的ID重复
		{
			url: "${CTX}/commonSearch/openHousingOwnership.do?houseInfoId="+$("#houseInfoId").val()+"&transType="+$("#demandTypeLayout").val()+"&limitExpressId="+$("#limitExpressId").val(),//调用页面的url 
			title: "房源归属",//弹框的title
			closeOnEscpe: true,//是否通过esc关闭弹框
			closeBtn: true,//是否显示关闭按钮
			width: $(window).width()*0.6,//弹框的宽度
			height: $(window).height()*0.8,//弹框的高度
			openCall: function() {
				//弹框打开后的回调函数
				$("#openProtect").parent().css("cssText", "position: absolute; width: "+$(window).width()*0.5+"px; height: "+$(window).height()*0.7+"px; left: "+$(window).width()*0.25+"px; top: "+$(window).height()*0.15+"px; display: block; z-index: 1041 !important;");
				$("#openProtect").parent().next().css("cssText", "z-index: 1040 !important;");
			},
			closeCall: function() {
				//弹框关闭后的回调函数
			}
		}
	)
},
/* 房产证录入 */
aihome.openPropertyCertificate = function() {
	oaDialogOpen(
		"openPropertyCertificate",//对话框ID，必填，且不能与当前页面的ID重复
		{
			url: "${CTX}/commonSearch/openPropertyCertificate.do?houseInfoId="+$("#houseInfoId").val(),//调用页面的url
			title: "房产证录入",//弹框的title
			closeOnEscpe: true,//是否通过esc关闭弹框
			closeBtn: true,//是否显示关闭按钮
			width: $(window).width()*0.4,//弹框的宽度
			height: $(window).height()*0.3,//弹框的高度
			buttons: {
				"撤销" : function() {
					if(aihome.deleteHouseDeed()) {
						$(this).dialog("close");
					}
				},
				"保存" : function() {
					if(aihome.insertHouseDeed()) {
						$(this).dialog("close");
					}
				},
				"取消" : function() {
					$(this).dialog("close");
				}
			},
			openCall: function() {
				//弹框打开后的回调函数
				$("#openProxyInput").parent().css("cssText", "position: absolute; width: "+$(window).width()*0.4+"px; height: "+$(window).height()*0.3+"px; left: "+$(window).width()*0.3+"px; top: "+$(window).height()*0.35+"px; display: block; z-index: 1041 !important;");
				$("#openProxyInput").parent().next().css("cssText", "z-index: 1040 !important;");
			},
			closeCall: function() {
				//弹框关闭后的回调函数
			}
		}
	)
},
/* 打假 */
aihome.openAntiCounterfeiting = function() {
	oaDialogOpen(
		"openAntiCounterfeiting",//对话框ID，必填，且不能与当前页面的ID重复
		{
			url: "${CTX}/commonSearch/openAntiCounterfeiting.do?houseInfoId="+$("#houseInfoId").val()+"&transType="+$("#demandTypeLayout").val(),//调用页面的url
			title: "打假",//弹框的title
			closeOnEscpe: true,//是否通过esc关闭弹框
			closeBtn: true,//是否显示关闭按钮
			width: $(window).width()*0.8,//弹框的宽度
			height: $(window).height()*0.8,//弹框的高度
			openCall: function() {
				//弹框打开后的回调函数
				$("#openAntiCounterfeiting").parent().css("cssText", "position: absolute; width: "+$(window).width()*0.6+"px; height: "+$(window).height()*0.7+"px; left: "+$(window).width()*0.2+"px; top: "+$(window).height()*0.15+"px; display: block; z-index: 1041 !important;");
				$("#openAntiCounterfeiting").parent().next().css("cssText", "z-index: 1040 !important;");
			},
			closeCall: function() {
				//弹框关闭后的回调函数
			}
		}
	)
},
/* 修改*/
aihome.houseEdit = function(){
	 var demmandType = $("#demandTypeLayout").val();//1买卖 2租赁
	 var useType = $("#propertyTypeLayout").val();//1住宅，2商铺，3写字楼，4车库
	 var houseInfoId = $("#houseInfoId").val();
	 var url;
	 var title;
	 if(demmandType==1){
		 url = "${CTX}/houseManage/getSellAddDialog.do?useType="+useType+"&houseInfoId="+houseInfoId;
		 title = "买卖房源修改";
	 }else{
		 url = "${CTX}/houseLease/getLeaseAddDialog.do?useType="+useType+"&houseInfoId="+houseInfoId;
		 title = "租赁房源修改";
	 } 
     if(useType==1){
		 title+="-住宅";
	 }else if(useType==2){
		 title+="-商铺";
	 }else if(useType==3){
		 title+="-写字楼";
	 }else{
		 title+="-车位";
	 }
     if(demmandType==1){
		 aihome.openSaleEditDialog(title,url);
	 }else{
		 aihome.openLeaseEditDialog(title,url)
	 } 
};
/* 租赁房源修改弹窗*/ 
aihome.openLeaseEditDialog = function(title,url){
	 oaDialogOpen(
		   "leaseEditDialog",{
			url: url,
			closeOnEscpe: true,
		    width : 1300,
		    height: $(window).height()-150,
		    modal : true,
	        title : title,
	        buttons : {
	            "确定" : function() {
	            	var data = $("#house_lease_Form").serialize();
		        	var addrDetail = $("#addrDetail").val();//具体地址
		        	var roomId = $("#roomId").val()!=undefined?$("#roomId").val():"";//房间id
		        	var houseUseType = $("#house_useType option:selected").val();//使用类别
		        	var remark = $("#remark").val();//备注
		        	if(addrDetail==""){
		        		alert("请选择具体地址！");
		        		return;
		        	}
		        	var linkmanflag = true;
					$("#lm_tbody tr").each(function(){
						var name = $(this).find("input[name='name']").val();
						var contactType = $(this).find("input[name='contactType']").val();
						if(name=="" || contactType==""){
							linkmanflag = false;
						}
					});
					if(!linkmanflag){
						alert("请完善联系人和联系方式！");
		        		return;
					}
		        	if(houseUseType==4){
		        		var carportId = $("#carPortId").val();
		        		if(carportId==""){
		        			alert("请选择车位号！");
		        			return;
		        		}
		        	}
		        	//业主姓名
		        	var ownerName = $("#lm_tbody tr:first").find("input[name='name']").val();
		        	//业主联系方式
		        	var ownerTel = $("#lm_tbody tr:first").find("input[name='contactType']").val();
		        	//房屋设施(住宅)
		        	var fwsh = "";
		        	$(".fwsh:checked").each(function(i){
	        	        if(i==0){
	        	        	fwsh = $(this).val();
	        	        }else{
	        	        	fwsh += (","+$(this).val());
	        	        }
       	        	});
		        	//室内家具(住宅)
		        	var furniture = "";
		        	$(".furniture:checked").each(function(i){
		        		if(i==0){
		        			furniture = $(this).val();
		        		}else{
		        			furniture += (","+$(this).val());
		        		}
		        	});
		        	//房源描述
		        	var special = "";
		        	$(".special:checked").each(function(i){
		        		if(i==0){
		        			special = $(this).val();
		        		}else{
		        			special += (","+$(this).val());
		        		}
		        	});
		        	//房源标签
		        	var tags = "";
		        	$(".tags:checked").each(function(i){
		        		if(i==0){
		        			tags = $(this).val();
		        		}else{
		        			tags += (","+$(this).val());
		        		}
		        	});
		        	//看房方式
		        	var lookWay = "";
		        	$(".lookWay:checked").each(function(i){
		        		if(i==0){
		        			lookWay = $(this).val();
		        		}else{
		        			lookWay += (","+$(this).val());
		        		}
		        	});
		        	//适合经营(商铺)
		        	var fitManagement = "";
		        	$(".fitManagement:checked").each(function(i){
		        		if(i==0){
		        			fitManagement = $(this).val();
		        		}else{
		        			fitManagement += (","+$(this).val());
		        		}
		        	});
		        	//联系人
		        	var list =[];
		        	$("#lm_tbody").children().each(function(){
	        			var type = $(this).find("#type option:selected").val();
						var name = $(this).find("input[name='name']").val();
						var contactType = $(this).find("input[name='contactType']").val();
						var obj='{"type":"'+type+'","name":"'+name+'","contactType":"'+contactType+'"}';
						list.push(obj);
		        	});
		        	data+="&addrDetail="+addrDetail+"&roomId="+roomId+"&useType="+houseUseType+"&remark="+remark+"&fwsh="+fwsh+
		        		  "&furniture="+furniture+"&special="+special+"&tags="+tags+"&fitManagement="+fitManagement+"&lookWay="+lookWay+
			        	  "&linkManList="+list.join("-")+"&ownerName="+ownerName+"&ownerTel="+ownerTel;
		        	//保存房源
		        	$.ajax({
						url : "${CTX}/houseLease/saveHouseLease.do",
						dataType : "json",
						type : "post",
						data : data,
						async : false,
						success : function(data) {
							if(data==1){
								alert("保存成功！");
							}else{
								alert("保存失败！");
							}
						}
					});  
		        	$(this).dialog("close");
		        	$("#house_lease_jqGrid").trigger('reloadGrid'); 
	            },
	            "取消" : function() {
	                $(this).dialog("close");
	            }
	        },
	        openCall: function() {
	        	
			},
			closeCall: function() {
				$(this).empty();
			}
	 });
},
/* 买卖房源修改弹窗 */
aihome.openSaleEditDialog = function(title,url){
	 oaDialogOpen(
		   "saleEditDialog",{
			url: url,
			closeOnEscpe: true,
		    width : 1300,
		    height: $(window).height()-150,
		    modal : true,
	        title : title,
	        buttons : {
	            "确定" : function() {
	            	var data = $("#house_sale_Form").serialize();
		        	var addrDetail = $("#addrDetail").val();//具体地址
		        	var useType = $("#form_useType option:selected").val();//使用类别
		        	var remark = $("#remark").val();//备注
		        	//判断是否是车位新增
		        	if(useType==4){
		        		var roomId = "";//房间id
		        	}else{
		        		var roomId = $("#roomId").val();//房间id
		        	}
		        	//具体地址必填校验
		        	if(addrDetail==""){
		        		alert("请选择具体地址！");
		        		return;
		        	}
		        	//车位id必填校验
		        	if(useType==4){
		        		var parkNum = $("#parkNum").val();
		        		if(parkNum==""){
		        			alert("请选择车位号！");
		        			return;
		        		}
		        	}
		        	//计算单价
		        	var sellPrice = $("#sellPrice").val();
		        	var coveredArea = $("#coveredArea").val();
		        	var unitPrice = 0;
		        	if(sellPrice!="" && coveredArea!="" && sellPrice!=0){
		        		unitPrice =Math.round((sellPrice*10000)/coveredArea);
		        	}
		        	
		        	var linkmanflag = true;
					$("#lm_tbody tr").each(function(){
						var name = $(this).find("input[name='name']").val();
						var contactType = $(this).find("input[name='contactType']").val();
						if(name=="" || contactType==""){
							linkmanflag = false;
						}
					});
					if(!linkmanflag){
						alert("请完善联系人和联系方式！");
		        		return;
					}
		        	
		        	//业主姓名
		        	var ownerName = $("#lm_tbody tr:first").find("input[name='name']").val();
		        	//业主联系方式
		        	var ownerTel = $("#lm_tbody tr:first").find("input[name='contactType']").val();
		        	
		        	//是否是凶宅haunted
		        	var haunted = "";
		        	var haunted2 = "";
		        	$("input[type=checkbox].haunted:checked").each(function(i){
		        		if(i==0){
		        			haunted = $(this).val();
		        			haunted2 = $(this).next().html();
		        		}else{
		        			haunted += (","+$(this).val());
		        			haunted2 += (","+$(this).next().html());
		        		}
		        	});
		        	//看房方式
		        	var lookWay ="";
		        	var lookWay2="";
		        	$("input[type=checkbox].lookWay:checked").each(function(i){
		        		if(i==0){
		        			lookWay = $(this).val();
		        			lookWay2 = $(this).next().html();
		        		}else{
		        			lookWay += (","+$(this).val());
		        			lookWay2 += (","+$(this).next().html());
		        		}
		        	});
		        	//房源描述
		        	var special = "";
		        	var special2 = "";
		        	$("input[type=checkbox].special:checked").each(function(i){
		        		if(i==0){
		        			special = $(this).val();
		        			special2 = $(this).next().html();
		        		}else{
		        			special += (","+$(this).val());
		        			special2 += (","+$(this).next().html());
		        		}
		        	});
		        	//房源标签
		        	var tags = "";
		        	var tags2 = "";
		        	$("input[type=checkbox].tags:checked").each(function(i){
		        		if(i==0){
		        			tags = $(this).val();
		        			tags2 = $(this).next().html();
		        		}else{
		        			tags += (","+$(this).val());
		        			tags2 += (","+$(this).next().html());
		        		}
		        	});
		        	//联系人
		        	var list =[];
		        	$("#lm_tbody").children().each(function(){
	        			var type = $(this).find("#type  option:selected").val();
						var name = $(this).find("input[name='name']").val();
						var contactType = $(this).find("input[name='contactType']").val();
						var obj='{"type":"'+type+'","name":"'+name+'","contactType":"'+contactType+'"}';
						list.push(obj);
		        	});
		        	
		        	data+="&addrDetail="+addrDetail+"&roomId="+roomId+"&useType="+useType+"&remark="+remark+"&haunted="+haunted+"&ownerName="+ownerName+"&ownerTel="+ownerTel+
		        	"&haunted2="+haunted2+"&lookWay="+lookWay+"&lookWay2="+lookWay2+"&special="+special+"&special2="+special2+"&tags="+tags+"&tags2="+tags2+"&unitPrice="+unitPrice+
		        	"&linkManList="+list.join("-");
		        	//保存房源
		        	$.ajax({
						url : "${CTX}/houseManage/insertHouseSale.do",
						dataType : "json",
						type : "post",
						data : data,
						success : function(data) {
							if(data==1){
								alert("保存成功！");
							}else{
								alert("保存失败！");
							}
						}
					});
		        	$(this).dialog("close");
		        	$("#jqGrid").trigger('reloadGrid');
	            },
	            "取消" : function() {
	                $(this).dialog("close");
	            }
	        },
	        openCall: function() {
	        	
			},
			closeCall: function() {
				$(this).empty();
			}
	 });
},
$(function () {
	var aWidth = $("#commonSearchTop").width() / 14;
	$("#commonSearch a").css("color", "blue");
	$("#commonSearchTop div").css({"display": "inline-block", "width": aWidth});
	$("#commonSearchBottom div").css({"display": "inline-block", "width": aWidth});
	// 收藏/取消收藏
	if($("#collectDisplay").val() == "true") {
		$("#addCollect").css("display", "inline");
		$("#deleteCollect").css("display", "none");
	} else {
		$("#addCollect").css("display", "none");
		$("#deleteCollect").css("display", "inline");
	}
	// 空看
	if($("#spaceSeeDisplay").val() == "false") {
		$("#spaceSee").css("display", "none");
		aWidth = $("#commonSearch").width() / 13;
		$("#commonSearchTop div").css("width", aWidth);
		$("#commonSearchBottom div").css({"display": "inline-block", "width": aWidth});
	}
})
</script>