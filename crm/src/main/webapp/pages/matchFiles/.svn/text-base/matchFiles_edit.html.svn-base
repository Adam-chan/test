<div class="row" id="editCategory">
	<div class="col-xs-12 my-group" enterforbtn="confirm-role">
		<div id="element_id">
			<div class="col-md-12">
				<div class="form-xs form-group row">
					<label class="col-xs-2 control-label">赛区名称：</label>
					<div class="col-xs-4">
						<#if updateDataObj??>
						<input id="editName" class="form-control input-xs" name="name" type="text" value="${updateDataObj.name!}" maxlength="16" >
						<#else>
						<input id="editName" class="form-control input-xs" name="name" type="text" value="" maxlength="16" >
						</#if>
					</div>
					
					<label class="col-xs-2 control-label">赛区类别：</label>
					<div class="col-xs-4">
						<select id="categorySel" class=" input-xs form-control">
						<#if updateDataObj??>
						<#list categoryNameList as item>
							<#if updateDataObj.categroyName == item.name > 
							<option id="${item.id!}" selected="selected">${item.name!}</option>
							<#else> 
							<option id="${item.id!}">${item.name!}</option>
							</#if>
						</#list>
						<#else>
							<option>请选择</option>
							<#list categoryNameList as item>
							<option id="${item.id!}">${item.name!}</option>
							</#list>
						</#if>
						</select>
					</div>	
				</div>
			</div>
			
			<div class="col-md-12">
				<div class="form-xs form-group row">
					<label class="col-xs-2 control-label">赛区级次：</label>
					<div class="col-xs-4">
						<select id="gradeSel" class=" input-xs form-control">
						<#if updateDataObj??>
							<#if updateDataObj.grade == "1">
							<option id="gradeOption" selected="selected">一级</option>
							<option id="gradeOption">二级</option>
							<option id="gradeOption">三级</option>
							<option id="gradeOption">四级</option>
							<option id="gradeOption">五级</option>
							<#elseif updateDataObj.grade == "2">
							<option id="gradeOption">一级</option>
							<option id="gradeOption" selected="selected">二级</option>
							<option id="gradeOption">三级</option>
							<option id="gradeOption">四级</option>
							<option id="gradeOption">五级</option>
							<#elseif updateDataObj.grade == "3">
							<option id="gradeOption">一级</option>
							<option id="gradeOption">二级</option>
							<option id="gradeOption" selected="selected">三级</option>
							<option id="gradeOption">四级</option>
							<option id="gradeOption">五级</option>
							<#elseif updateDataObj.grade == "4">
							<option id="gradeOption">一级</option>
							<option id="gradeOption">二级</option>
							<option id="gradeOption">三级</option>
							<option id="gradeOption" selected="selected">四级</option>
							<option id="gradeOption">五级</option>
							<#elseif updateDataObj.grade == "5">
							<option id="gradeOption">一级</option>
							<option id="gradeOption">二级</option>
							<option id="gradeOption">三级</option>
							<option id="gradeOption">四级</option>
							<option id="gradeOption" selected="selected">五级</option>
							</#if>
						<#else>
							<option id="gradeOption">请选择</option>
							<option id="gradeOption">一级</option>
							<option id="gradeOption">二级</option>
							<option id="gradeOption">三级</option>
							<option id="gradeOption">四级</option>
							<option id="gradeOption">五级</option>
						</#if>
						</select>
					</div>
					
					<label class="col-xs-2 control-label">业务类型：</label>
					<div class="col-xs-4">
						<#if updateDataObj??>
							<#if updateDataObj.bussunessType == "1">
							<input type="checkbox" value="business" id="businessBox" checked="checked"> 买卖
							&nbsp;&nbsp;&nbsp;
							<input type="checkbox" value="lease" id="leaseBox"> 租赁
							<#elseif updateDataObj.bussunessType == "2">
							<input type="checkbox" value="business" id="businessBox"> 买卖
							&nbsp;&nbsp;&nbsp;
							<input type="checkbox" value="lease" id="leaseBox" checked="checked"> 租赁
							<#elseif updateDataObj.bussunessType == "3">
							<input type="checkbox" value="business" id="businessBox" checked="checked"> 买卖
							&nbsp;&nbsp;&nbsp;
							<input type="checkbox" value="lease" id="leaseBox" checked="checked"> 租赁
							</#if>
						<#else>
							<input type="checkbox" value="business" id="businessBox"> 买卖
							&nbsp;&nbsp;&nbsp;
							<input type="checkbox" value="lease" id="leaseBox"> 租赁
						</#if>
					</div>
				</div>
			</div>
			
			<div class="col-md-12 col-sm-12">
				<div class="form-xs form-group row">
					<label class="col-xs-2 control-label">买卖战队：</label>
					<div class="col-xs-1">
						<a onclick="aihome.showAddPage(1)"><i class="glyphicon  glyphicon-plus" style="font-size: 20px"></i></a>
					</div>
					<div class="col-xs-9 " id="cloneTarget">
					<#if updateDataObj??>
	                    <textarea id ="businessTeams" rows="3" cols="60" style="width: 100%;" readonly="readonly">${updateDataObj.businessTeamName!}</textarea>
	                <#else>
	                    <textarea id ="businessTeams" rows="3" cols="60" style="width: 100%;" readonly="readonly"></textarea>
	                </#if>
					</div>
				</div>
			</div>
			
			<div class="col-md-12 col-sm-12">
				<div class="form-xs form-group row">
					<label class="col-xs-2 control-label">租赁站队：</label>
					<div class="col-xs-1">
						<a onclick="aihome.showAddPage(2)"><i class="glyphicon  glyphicon-plus" style="font-size: 20px"></i></a>
					</div>
					<div class="col-xs-9 " id="cloneTarget">
					<#if updateDataObj??>
	                    <textarea id ="leaseTeams" rows="3" cols="60" style="width: 100%" readonly="readonly">${updateDataObj.leaseTeamName!}</textarea>
	                <#else>
	                    <textarea id ="leaseTeams" rows="3" cols="60" style="width: 100%" readonly="readonly"></textarea>
	                </#if>
					</div>
				</div>
			</div>
			
			<div class="col-md-12 col-sm-12">
				<div class="form-xs form-group row">
					<label class="col-xs-2 control-label">备注：</label>
					<div class="col-xs-10 " id="cloneTarget">
					<#if updateDataObj??>
	                	<textarea id ="remarks" rows="3" cols="60" style="width: 100%">${updateDataObj.remark!}</textarea>
	                <#else>
	                   	<textarea id ="remarks" rows="3" cols="60" style="width: 100%"></textarea>
					</#if>
					</div>
				</div>
			</div>
			
			<div id="hideArea" hidden="hidden">
				<div id="tree">
					<ul id="ulTree"></ul>
				</div>
			</div>
			<#if readType??>
				<input value="${readType!}" id="readType" style="display: none;">
			<#else>
				<input id="readType" style="display: none;" value="">
			</#if>
		</div>
	</div>
</div>
<style>
li{
 list-style-type: none;
}
</style>
<script type="text/javascript">
var aihome = {
	showAddPage : function(type) {
		var title = "";
		var businessBox = $("#businessBox")[0].checked;//业务类型(买卖)
		var leaseBox = $("#leaseBox")[0].checked;//业务类型(租赁)
		var categorySel = $("#categorySel").val();//赛区类别
		if(categorySel == "请选择"){
			alert("请选择赛区类别");
			return;
		}
		if(businessBox == false && leaseBox == false){
			alert("请在选择业务类型后添加对应的业务战队");
			return;
		}
		if(type == 1){
			if(businessBox == false){
				alert("业务类型未选择买卖业务,请添加所选业务战队");
				return;
			}
			title = "买卖战队";
			var layer = aihome.getCategoryLayer(categorySel);
			aihome.getBusinessTeam();
		}else if(type == 2){
			if(leaseBox == false){
				alert("业务类型未选择租赁业务,请添加所选业务战队");
				return;
			}
			title = "租赁战队";
			var layer = aihome.getCategoryLayer(categorySel);
			aihome.getLeaseTeam();
		}
		var html = $("#hideArea").html();
		bootbox.dialog({
			title:title,
            message: html,
            /* Cancel: {  
                label: "Cancel",  
                className: "btn-default",  
                callback: function () {  
                    alert("Cancel");  
                }  
            } */
            buttons: {
            	"确定" : {
            		callback : function(){
                		var text = "";
                		$("#ulTree input[type = 'checkbox']:checked").each(function() {
                            text += $(this).parent().text() + ",";
                        });
                		if(title == "买卖战队"){
                			$("#businessTeams").text(text.substring(0,text.length-1));
                		}else if(title == "租赁战队"){
                			$("#leaseTeams").text(text.substring(0,text.length-1));
                		}
    				},
    				className: "btn-sm btn-blue"
            	},
                "取消" : {
                	className: "btn-sm btn-grey",
                	callback : function(){
    				}
                }
            }
        });
	},
	getBusinessTeam : function(){
		aihome.getTree();
	},
	getLeaseTeam : function(){
		aihome.getTree();
	},
	getCategoryLayer : function(categorySel){
		var layer = "";
		$.ajax({
		  url : "${CTX}/matchFiles/getCategoryLayer.do",
		  type:"post",
		  dataType:"json",
		  async : false,
		  data:{
			  name : categorySel
		  },
		  success:function(data){
			 layer = data.layer;
		  }
		 });
		return layer;
	},
	getTree : function(count){
		$.ajax({
			  url : "${CTX}/matchFiles/getBusinessTeam.do",
			  type:"post",
			  dataType:"json",
			  async : false,
			  success:function(data){
				  if($("#ulTree").html() == "" || $("#ulTree").html() == null){
					for(var i = 0 ; i < data.length ; i++){
						var ulArea = $("<li><a style='text-decoration: none;' onclick = 'aihome.open(this)'>-</a>"+data[i].area+"</li><ul id= area"+i+"></ul>");
						$("#ulTree").append(ulArea);
						for(j = 0 ; j < data[i].team.length ; j++){
							var ulTeam = $("<li><input type='checkbox'/>"+data[i].team[j]+"</li>");
							$("#area"+i).append(ulTeam);
						}
					}
				  }
			  }
		 	});
	},
	open : function(openStatus){
		var openState = $(openStatus).text();
		if(openState == "-"){
			$(openStatus).parent().next().hide();
			$(openStatus).text("+");
		}else if(openState == "+"){
			$(openStatus).parent().next().show();
			$(openStatus).text("-");
		}
	},
	read : function(){
		if($("#readType").val() == "read"){
			$("input").attr("disabled" , true);
			$("textarea").attr("disabled" , true);
			$("select").attr("disabled" , true);
			$("a").removeAttr("onclick");
		}
	}
};

$(function (){
	aihome.read();
});
</script>
