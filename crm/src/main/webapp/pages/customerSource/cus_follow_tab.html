<div class="widget-header widget-header-small">
	<div class="widget-toolbar pull-left" >
	    <a href="javaScript:void(0);" onclick="aihome.toAddFollow();" >
	      <i class="">添加</i>
	    </a>
	</div>
</div>
<table id="followJqGrid"></table>
<div id="followJqGridPager"></div>
<input type="hidden" id="custDemandId" value ="${(custDemandId)!''}" />
<script type="text/javascript">
	
	/*初始化分页页面*/
	aihome.followInit = function () {
		$("#followJqGrid")
				.jqGrid(
						{
							height : $(window).height() - 279,
							multiselect : true,
							multiboxonly : true,
							viewrecords : true,
							rownumbers : true,
							autowidth : true,
							autoheight : true,
							async : false,
							url : "${CTX}/customerSource/getFollowTabPage.do",
							postData : {
								demandId : $("#custDemandId").val()
							},
							datatype : "json",
							colNames : [ '跟踪类型', '跟踪人', '跟踪时间' ,
							             '跟踪方式', '跟踪备注'],
							colModel : [       
										{name : 'type',sortable : false,width : 6,align : 'center',
											formatter:function(rowName, options, rowObject){
								             /* 写到这 很乱 写到这 很乱写到这 很乱写到这 很乱写到这 很乱写到这 很乱写到这 很乱*/
											}
										},
										{name : 'operaterUser',sortable : false,width : 5,align : 'center'},  
										{name : 'followTimeStr',sortable : false,width : 6,align : 'center'},
										{name : 'followWay',sortable : false,width : 6,align : 'center',							
											formatter:function(rowName, options, rowObject){
							            		 var followWay = rowObject.followWay;
												 var html = "";
												 if(followWay){
													 if(followWay == 1){
														 html += "QQ";
													 }else if(followWay == 2){
														 html += "电话";
													 }else if(followWay == 3){
														 html += "邮件";
													 }else if(followWay == 4){
														 html += "短信";
													 }else if(followWay == 5){
														 html += "手机";
													 }
												 }
							            	     return html;
								             }},
										{name : 'content',sortable : false,width : 6,align : 'center'},
										],
							rowNum : 30,
							rowList : [ 10, 20, 30, 50, 100 ],
							pager : "#followJqGridPager",
							jsonReader : {
								root : 'pagerResults',
								page : 'currentPage',
								rows : 'rowCount',
								total : 'pageCount',
								records : 'totalCount',
								repeatitems : false
							}
						});
	}
	
	/* 添加跟进 */
	aihome.toAddFollow = function(){
		oaDialogOpen("toAddFollow",//对话框ID，必填，且不能与当前页面的ID重复
				 {url:"${CTX}/customerSource/toAddFollow.do",
					title:"添加跟进",//弹框的title
					closeOnEscpe:true,//是否通过escpe关闭弹框
					closeBtn:true,//是否显示关闭按钮
					width: $(window).width()*0.3,//弹框的宽度
					height: $(window).height()*0.4,
					buttons : {
						"确定" : function() {
							aihome.follow();
							$(this).dialog("close");
				          	$("#followJqGrid").trigger('reloadGrid');
						}
					}
			  })
		};
	
	$(function() {
		aihome.followInit();
	});
</script>