<div class="col-sm-12 col-xs-12 my-group">
	<div class="form-horizontal row ">

		<div class=" row ">
			<div class="col-md-4 col-sm-4">
				<div class="form-xs form-group row">
					<label for="takeTypeCust" class="col-xs-4 control-label">范围：</label>
					<div class="col-xs-8">
						<select id="takeTypeCust" class="input-xs form-control">
							<option value="0"></option>
							<option value="1">收藏盘</option>
							<option value="2">责任盘</option>
							<option value="3">经营盘</option>
						</select>
					</div>
				</div>
			</div>

			<div class="col-md-8 col-sm-8">
				<div class="form-xs form-group row"></div>
			</div>
		</div>

		<div class=" row ">
			<div class="col-md-4 col-sm-4">
				<div class="form-xs form-group row">
					<label for="codeCust" class="col-xs-4 control-label">房源编号：</label>
					<div class="col-xs-8">
						<input id="codeCust" class="form-control input-xs" />
					</div>
				</div>
			</div>
			<div class="col-md-8 col-sm-8">
				<div class="form-xs form-group row">
					<label for="price" class="col-xs-4 control-label">价格：</label>
					<div class="col-xs-8">
						<input id="priceStartCust" class=" input-xs" style="width: 40%;" />--
						<input id="priceEndCust" class=" input-xs" style="width: 40%;" />万元
					</div>
				</div>
			</div>
		</div>

		<div class=" row ">
			<div class="col-md-4 col-sm-4">
				<div class="form-xs form-group row">
					<label for="" class="col-xs-4 control-label">面积：</label>
					<div class="col-xs-8">
						<input id="areaStartCust" class=" input-xs" style="width: 40%;" />--
						<input id="areaEndCust" class=" input-xs" style="width: 40%;" />m&sup2;
					</div>
				</div>
			</div>
			<div class="col-md-8 col-sm-8">
				<div class="form-xs form-group row">
					<label for="price" class="col-xs-4 control-label">户型 ：</label>
					<div class="col-xs-8">
						<input id="roomsCust" class="input-xs" style="width: 20%;" />室 <input
							id="officeCust" class=" input-xs" style="width: 20%;" />厅 <input
							id="wcCust" class=" input-xs" style="width: 20%;" />卫 <input
							id="kitchenCust" class=" input-xs" style="width: 20%;" />厨
					</div>
				</div>
			</div>
		</div>

		<div class=" row ">
			<div class="col-md-4 col-sm-4">
				<div class="form-xs form-group row">
					<label for="" class="col-xs-4 control-label">楼层：</label>
					<div class="col-xs-8">
						<input id="floorStartCust" class=" input-xs" style="width: 40%;" />--
						<input id="floorEndCust" class=" input-xs" style="width: 40%;" />层
					</div>
				</div>
			</div>
			<div class="col-md-8 col-sm-8">
				<div class="form-xs form-group row">
					<label for="decoradion" class="col-xs-4 control-label">装修情况：</label>
					<div class="col-xs-2">
						<select id="decoradionCust" class="input-xs form-control">
							<option value=""></option>
							<option value="1">毛坯</option>
							<option value="2">简装</option> 
							<option value="3">精装</option>
							<option value="4">豪装</option>
							<option value="5">中等</option>
						</select>
					</div>
				</div>
			</div>
		</div>

		<div class=" row ">
			<div class="col-md-4 col-sm-4">
				<div class="form-xs form-group row">
					<label for="premisesName" class="col-xs-4 control-label">楼盘：</label>
					<div class="col-xs-8">
						<input id="premisesName"  class="form-control input-xs" placeholder="楼盘名称"/>
						<input id="premisesIdCust" class="form-control input-xs searchKey"  type="hidden" />	 
					</div>
				</div>
			</div>
		</div>

		<div class=" row ">
			<div class="col-md-4 col-sm-4">
				<div class="form-xs form-group row">
					<label for="" class="col-xs-4 control-label">商圈：</label>
					<div class="col-xs-8">
						<input id="businessAreaCust" class="form-control input-xs" placeholder="商圈名称"/>
						<input type="hidden" id=busiAreaId class="form-control input-xs searchKey" />	
					</div>
				</div>
			</div>
			<div class="col-md-1 col-sm-1">
			</div>
			<div class="col-md-6 col-sm-6">
				<div class="form-xs form-group row">
					<div class="col-xs-8">
					<button  class="btn btn-sm btn-blue"
						onclick="aihome.queryAddCustSource();">
						 <span>查询</span>
					</button>
						<button  class="btn btn-sm btn-blue"
							onclick="aihome.cleanAddCustSource();">
							 <span>清空</span>
						</button>
					</div>
				</div>
			</div>
		</div>

	</div>

	<table id="addCustJqGrid"></table>
	<div id="addCustJqGridPager"></div>
</div>


<script type="text/javascript">
aihome.addCustInit = function () {
	$("#addCustJqGrid")
			.jqGrid(
					{
						height : $(window).height()*0.7,
						multiselect : true,
						multiboxonly : true,
						viewrecords : true,
						rownumbers : true,
						autowidth : true,
						autoheight : true,
						async : false,
						url : "${CTX}/customerSource/getHouseSourcePage.do",
						postData : {
							demandType :$("#demandType").val(),
							propertyType :$("#propertyType").val()
						},
						datatype : "json",
						colNames : [ '房源编号', '楼盘', '价格（万元）','面积（m&sup2;）', '户型', 
										'楼层','装修','房源地址 ','房源id','楼层','朝向 ','小区名','useType','code','houseInfoId'],
						colModel : [       
									{name : 'houseCode',sortable : false,width : 8,align : 'center',
										formatter:function(rowName, options, rowObject){
											 var html = "";
											 if(rowObject.code){
												 var demandType = $("#demandType").val();
												 html += "<a style='color: blue;' onclick='aihome.houseDetail(" + rowObject.houseInfoId +","+demandType+","+rowObject.useType + ");'>"+rowObject.code +"<a/>";
											 }
											 if(rowObject.ownerName){
												 html += "/"+rowObject.ownerName;
											 }
						            	     return html;
							             }}, 
									{name : 'premisesName',sortable : false,width : 8,align : 'center'}, 
									{name : 'leasePrice',sortable : false,width : 4,align : 'center'}, 
									{name : 'coveredArea',sortable : false,width : 4,align : 'center'}, 
									{name : 'floorType',sortable : false,width : 6,align : 'center',
										formatter:function(rowName, options, rowObject){
										 var html = "";
										 if(rowObject.rooms){
											 html += rowObject.rooms+"室";
										 }
										 if(rowObject.office){
											 html += rowObject.office+"厅";
										 }
										 if(rowObject.wc){
											 html += rowObject.wc+"卫";
										 }
					            	     return html;
						             }}, 
									{name : 'floors',sortable : false,width : 4,align : 'center',
						            	 formatter:function(rowName, options, rowObject){
						            		 var chaoXiang = rowObject.chaoXiang;
											 var html = "";
											 if(rowObject.floor){
												 html += rowObject.floor+"层";
											 }
											 html +="（";
											 if(chaoXiang){
												 if(chaoXiang == 1){
													 html += "东";
												 }else if(chaoXiang == 2){
													 html += "南";
												 }else if(chaoXiang == 3){
													 html += "西";
												 }else if(chaoXiang == 4){
													 html += "北";
												 }
											 }
											 html +="）";
						            	     return html;
							             } }, 
									{name : 'decoradionStr',sortable : false,width : 4,align : 'center'},
									{name: 'addressDetail', index: 'addressDetail', hidden: true},
									{name: 'houseInfoId', index: 'houseInfoId', hidden: true},
									{name: 'floor', index: 'floor', hidden: true},
									{name: 'useType', index: 'useType', hidden: true},
									{name: 'code', index: 'code', hidden: true},
									{name: 'houseInfoId', index: 'houseInfoId', hidden: true},
									{name: 'communityName', index: 'communityName', hidden: true},
									{name: 'chaoXiang', index: 'chaoXiang', hidden: true,
										formatter:function(rowName, options, rowObject){
						            		 var chaoXiang = rowObject.chaoXiang;
											 var html = "";
											 if(chaoXiang){
												 if(chaoXiang == 1){
													 html += "东";
												 }else if(chaoXiang == 2){
													 html += "南";
												 }else if(chaoXiang == 3){
													 html += "西";
												 }else if(chaoXiang == 4){
													 html += "北";
												 }
											 }
						            	     return html;
							             }}
									],
						rowNum : 10,
						rowList : [ 10, 20, 30, 50, 100 ],
						pager : "#addCustJqGridPager",
						jsonReader : {
							root : 'pagerResults',
							page : 'currentPage',
							rows : 'rowCount',
							total : 'pageCount',
							records : 'totalCount',
							repeatitems : false
						}
					});
}
/* 查询 */
aihome.queryAddCustSource = function () {
	$("#addCustJqGrid").setGridParam({
		postData : {
			codeCust : $("#codeCust").val(),
			priceStartCust : $("#priceStartCust").val(),
			priceEndCust : $("#priceEndCust").val(),
			areaStartCust : $("#areaStartCust").val(),
			areaEndCust : $("#areaEndCust").val(),
			roomsCust : $("#roomsCust").val(),
			officeCust : $("#officeCust").val(),
			kitchenCust : $("#kitchenCust").val(),
			wcCust : $("#wcCust").val(),
			decoradionCust : $("#decoradionCust").val(),
			premisesName : $("#premisesName").val(),
			busiAreaId : $("#busiAreaId").val(),
			floorStartCust : $("#floorStartCust").val(),
			floorEndCust : $("#floorEndCust").val()
			
		}
	}).trigger("reloadGrid");
}

/* 清空 */
aihome.cleanAddCustSource = function () {
	$("#codeCust").val(''),
	$("#priceStartCust").val(''),
	$("#priceEndCust").val(''),
	$("#areaStartCust").val(''),
	$("#areaEndCust").val(''),
	$("#roomsCust").val(''),
	$("#officeCust").val(''),
	$("#kitchenCust").val(''),
	$("#wcCust").val(''),
	$("#decoradionCust").val(''),
	$("#premisesName").val(''),
	$("#businessAreaCust").val(''),
	$("#floorStartCust").val(''),
	$("#floorEndCust").val('')
	
}

/* 保存添加 */
aihome.saveAddCustSource = function () {
	var rowIds = $("#addCustJqGrid").jqGrid('getGridParam','selarrrow');
	
	var selCount=rowIds.length;
	if (selCount==0){
		alert("没有选中的房源！");
		return null;
	}
	
	var ObjArray = new Array();
	for(i = 0;i < selCount;i ++){
		var id = rowIds[i];
		var rowData = $("#addCustJqGrid").jqGrid('getRowData',id);
		ObjArray.push(rowData.addressDetail+","+rowData.floorType +","+rowData.coveredArea +","
				+rowData.floor +","+rowData.chaoXiang+","+rowData.houseInfoId+","+rowData.communityName+","
				+rowData.code+","+rowData.useType+","+rowData.houseInfoId);
	}
	
	return ObjArray;
	
}

$("#businessAreaCust").autocomplete({
	source : function(request, response) {
		$.ajax({
			url:'${ADDR_CTX}/busiArea/getBusiNameList.do',
			dataType : "json",
			type : 'post',
			data : {
				'busiAreaName' : request.term
			},
			success : function(data) {
				var arr = new Array(data.length);
				for (var i = 0; i < data.length; i++) {
					var s = {
						label : data[i].busiAreaName,
						value : data[i].id
					};
					arr[i] = s;
				}
				response(arr); 
			}
	});
	},
	select : function(event, ui) {
		$("#businessAreaCust").val(ui.item.label);
		$("#busiAreaId").val(ui.item.value);
		event.preventDefault();
	}
});

/* 楼盘模糊搜索*/
$("#premisesName").autocomplete({
	source : function(request, response) {
		$.ajax({
			url : "${ADDR_CTX}/premisesExamine/getPremisesListByMatch.do",
			dataType : "json",
			type : 'post',
			data : {
				matchStr : request.term
			},
			success : function(data) {
				var array = new Array(data.length);
				for (var i = 0; i < data.length; i++) {
					var temp = {
						key : data[i].id,
						value : data[i].name
					};
					array[i] = temp;
				}
				response(array);
			}
		});
	},
	select : function(event, ui) {
		$("#premisesIdCust").val(ui.item.key);
		$("#premisesName").val(ui.item.value);
		event.preventDefault();
	}
});

$(function() {
	aihome.addCustInit();
});
</script>
