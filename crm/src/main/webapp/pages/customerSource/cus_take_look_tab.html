<table id="lookManageJqGrid"></table>
<div id="lookManageJqGridPager"></div>
<input type="hidden" id="custDemandId" value ="${(custDemandId)!''}" />
<script type="text/javascript">
	
	/*初始化分页页面*/
	aihome.lookManageInit = function () {
		$("#lookManageJqGrid")
				.jqGrid(
						{
							height : $(window).height() - 279,
							multiselect : true,
							multiboxonly : true,
							viewrecords : true,
							rownumbers : true,
							autowidth : true,
							autoheight : true,
							async : false,
							url : "${CTX}/customerSource/getTakeLookTabPage.do",
							postData : {
								demandId : $("#custDemandId").val()
							},
							datatype : "json",
							colNames : [ '房源编号', '楼盘', '总价/万', '总价', '约看时间', '约看人', 
							             '带看时间', '备注描述' ,'回访时间'],
							colModel : [       
										{name : 'houseCode',sortable : false,width : 6,align : 'center'}, 
										{name : 'premisesName',sortable : false,width : 5,align : 'center',
											formatter:function(rowName, options, rowObject){
											 if(rowObject.premisesName){
						            	     	return rowObject.premisesName;
											 }else if(rowObject.premisesName2){
						            	     	return rowObject.premisesName2;
											 }else{
												 return "";
											 }
							             }},
										{name : 'totalPrice',sortable : false,width : 5,align : 'center'},
										{name : 'totalPrice2',sortable : false,width : 5,align : 'center',							
											formatter:function(rowName, options, rowObject){
							            	     return rowObject.totalPrice;
								             }
										},  
										{name : 'promiseDateStr',sortable : false,width : 6,align : 'center'},
										{name : 'takeUser',sortable : false,width : 5,align : 'center'}, 
										{name : 'takeDateStr',sortable : false,width : 6,align : 'center'},
										{name : 'remark',sortable : false,width : 6,align : 'center'},
										{name : 'visitTimeStr',sortable : false,width : 6,align : 'center'},
										],
							rowNum : 30,
							rowList : [ 10, 20, 30, 50, 100 ],
							pager : "#lookManageJqGridPager",
							jsonReader : {
								root : 'pagerResults',
								page : 'currentPage',
								rows : 'rowCount',
								total : 'pageCount',
								records : 'totalCount',
								repeatitems : false
							},
							gridComplete: function(){
								if($("#demandType").val()==2){//租赁价 元
									$("#lookManageJqGrid").setGridParam().hideCol("totalPrice").trigger("reloadGrid");
									$("#lookManageJqGrid").setGridWidth(950);
								}else{
									$("#lookManageJqGrid").setGridParam().hideCol("totalPrice2").trigger("reloadGrid");
									$("#lookManageJqGrid").setGridWidth(950);
								}
							}
						});
	}
	
	/* 房源详情 */
	aihome.showHouseInfo = function(houseId,type,num){
		oaDialogOpen("lookUpHouse",//对话框ID，必填，且不能与当前页面的ID重复
				 {url:"${CTX}/houseManage/lookUpDetail.do?houseInfoId="+houseId+"&type="+type+"&num="+num,
				      title:"查看详细信息",//弹框的title
				      closeOnEscpe:true,//是否通过escpe关闭弹框
				      closeBtn:true,//是否显示关闭按钮
				      width: $(window).width()*0.8,//弹框的宽度
					  height: $(window).height()*0.9,
				  })
		}
	

	$(function() {
		aihome.lookManageInit();
	});
</script>