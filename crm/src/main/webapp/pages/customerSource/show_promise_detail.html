<div class="row">
<div class="col-xs-12 my-grid">
	<table id="callBackPromiseJqGrid"></table>
	<div id="callBackPromiseJqGridPager"></div>
</div>
</div>
<input id="demandId" type="hidden" value="${demandId !''}"/>	
<input id="takeDate" type="hidden" value="${takeDate !''}"/>	
<script type="text/javascript">	
	/*初始化分页页面*/
	aihome.callBackPromise = function () {
		$("#callBackPromiseJqGrid").jqGrid({
							height : $(window).height()  * 0.7,
							multiselect : true,
							multiboxonly : true,
							viewrecords : true,
							rownumbers : true,
							autowidth : true,
							autoheight : true,
							async : false,
							url : "${CTX}/customerSource/getCallBackPromisePage.do",
							postData : {
								demandId : $("#demandId").val(),
								takeDate : $("#takeDate").val()
							},
							datatype : "json",
							colNames : ['房源编号', '业务类型', '录入时间','约带看时间', '带看人' 
							             , '陪看人' , '备注' ,'houseInfoId','useType'],
					            
							colModel : [
										{name : 'houseCode',sortable : false,width : 7,align : 'center',
											 formatter:function(rowName, options, rowObject){
												 var html = "";
												 if(rowObject.houseCode){
													 if(rowObject.demandType == 2){
														 html += "<a href=\"javascript:aihome.houseDetail('"+rowObject.houseInfoId+"',2,"+rowObject.useType+");\"  style='color:blue'>"+rowObject.houseCode+"</a>";
													 }else if(rowObject.demandType == 1){
														 html += "<a href=\"javascript:aihome.houseDetail('"+rowObject.houseInfoId+"',1,"+rowObject.useType+");\"  style='color:blue'>"+rowObject.houseCode+"</a>";
													 }
												 }
							            	     return html;
								             }}, 
								        {name : 'demandType',sortable : false,width : 3,align : 'center',
												 formatter:function(rowName, options, rowObject){
													 var html = "";
														 if(rowObject.demandType == 2){
															 html += "租赁";
														 }else if(rowObject.demandType == 1){
															 html += "买卖";
														 }
								            	     return html;
									             }},  
										{name : 'createTimeStr',sortable : false,width : 6,align : 'center'},
										{name : 'takeDateStr',sortable : false,width : 6,align : 'center'},
										{name : 'takeUser',sortable : false,width : 4,align : 'center'},
										{name : 'accompany',sortable : false,width : 4,align : 'center'},
										{name : 'remark',sortable : false,width : 6,align : 'center'},
										{name : 'houseInfoId',hidden:true},
										{name : 'useType',hidden:true}
										],
							rowNum : 30,
							rowList : [ 10, 20, 30, 50, 100 ],
							pager : "#callBackPromiseJqGridPager",
							jsonReader : {
								root : 'pagerResults',
								page : 'currentPage',
								rows : 'rowCount',
								total : 'pageCount',
								records : 'totalCount',
								repeatitems : false
							}
				});
	}
	
	//查看租赁房源详情页
	aihome.houseDetail = function(houseId,type,num){
		oaDialogOpen("lookUpHouse",//对话框ID，必填，且不能与当前页面的ID重复
			 {url:"${CTX}/houseLease/lookUpDetail.do?houseInfoId="+houseId+"&type="+type+"&num="+num,
			      title:"查看详细信息",//弹框的title
			      closeOnEscpe:true,//是否通过escpe关闭弹框
			      closeBtn:true,//是否显示关闭按钮
			      width: $(window).width()*0.8,//弹框的宽度
				  height: $(window).height()*0.9,
			  })
	}
	
	$(function(){
		aihome.callBackPromise(); 
	});
	
</script>	