<div class="row">
<form id="saveForm">
	<div class="col-xs-12 my-group" enterforbtn="confirm-role">
		<div class="form-horizontal row my-inputs">
		     <div class="col-md-7 col-sm-7 col-xs-7" style="margin-left: 50px;">
		          <div class="form-xs form-group row">
			          <div class="input-daterange input-group 5i5jdate">
						<input id="openStartTime" name="openStartTime"  type="text" class="form-control input-xs" placeholder="开始时间" value="${(result.startTimeStr)! ''}" >
						<span class="input-group-addon addon-xs">～</span>
						<input id="openEndTime" name="openEndTime"  type="text" class="form-control input-xs" placeholder="结束时间" value="${(result.endTimeStr)! ''}" >
					</div>
		        </div>
		   	</div>
		   	<label style="color:red;" class="col-xs-3 control-label" value="">比例总和为100%</label>
		</div>
	</div>
	<div class="col-md-12 col-sm-6" style="margin-top: 20px;">
		<div class=" form-xs form-group row">
			<label for="userName" class="col-xs-3 control-label" value="">房源录入比例:</label>
			<div class="col-xs-4"style="padding-right:0;">
			 	<input id="houseEnter" name="houseEnter" class="form-control input-xs" required onkeyup="this.value=this.value.replace(/\D/g,'')" onafterpaste="this.value=this.value.replace(/\D/g,'')" maxlength="2" placeholder="房源录入比例:" value="${(result.houseEnter)! ''}" />
			</div>
			<div class=" control-label" value="">%</div>
		</div>	
	</div>
	<div class="col-md-12 col-sm-6">
		<div class=" form-xs form-group row">
			<label for="userName" class="col-xs-3 control-label" value="">成交人比例:</label>
			<div class="col-xs-4" style="padding-right:0;">
			 	<input id="dealMan" name="dealMan" class="form-control input-xs" required onkeyup="this.value=this.value.replace(/\D/g,'')" onafterpaste="this.value=this.value.replace(/\D/g,'')" maxlength="2" placeholder="成交人比例:" value="${(result.dealMan)! ''}" />
			</div>
			<div class=" control-label" value="">%</div>
		</div>
	</div>
	<div class="col-md-12 col-sm-6">
		<div class=" form-xs form-group row">
			<label for="userName" class="col-xs-3 control-label" value="">收钥匙人比例:</label>
			<div class="col-xs-4" style="padding-right:0;">
			 	<input id="collKeysMan" name="collKeysMan" class="form-control input-xs" required maxlength="2" onkeyup="this.value=this.value.replace(/\D/g,'')" onafterpaste="this.value=this.value.replace(/\D/g,'')" placeholder="收钥匙人比例:" value="${(result.collKeysMan)! ''}" />
			</div>
			<div class=" control-label" value="">%</div>
		</div>
	</div>
	<div class="col-md-12 col-sm-6">
		<div class=" form-xs form-group row">
			<label for="userName" class="col-xs-3 control-label" value="">实勘人比例:</label>
			<div class="col-xs-4" style="padding-right:0;">
			 	<input id="collRoomMan"  name="collRoomMan" class="form-control input-xs" required maxlength="2" onkeyup="this.value=this.value.replace(/\D/g,'')" onafterpaste="this.value=this.value.replace(/\D/g,'')" placeholder="实勘人比例:" value="${(result.collRoomMan)! ''}" />
			</div>
			<div class=" control-label" value="">%</div>
		</div>	
	</div>
	<div class="col-md-12 col-sm-6">
		<div class=" form-xs form-group row">
			<label for="userName" class="col-xs-3 control-label" value="">收房人比例:</label>
			<div class="col-xs-4"style="padding-right:0;">
			 	<input id="realProMan" name="realProMan" class="form-control input-xs" required maxlength="2" onkeyup="this.value=this.value.replace(/\D/g,'')" onafterpaste="this.value=this.value.replace(/\D/g,'')" placeholder="收房人比例：" value="${(result.realProMan)! ''}" />
			</div>
			<div class=" control-label" value="">%</div>
		</div>	
	</div>
</form>
</div>
<script type="text/javascript">
aihome.validateFunction = function(){
	return $("#saveForm").validate({
		onfocusout: function(element){$(element).valid()},  
		messages:{
			houseEnter:{       
				required:"不能为空!",
			},
			dealMan:{       
				required:"不能为空!",
			},
			collKeysMan:{       
				required:"不能为空!",
			},
			collRoomMan:{       
				required:"不能为空!",
			},
			realProMan:{     
				required:"不能为空!",
			},
		},
	    errorPlacement: function(error, element){
	        error.appendTo(element.parent());
	    }
	});	
}
aihome.judgeEdit = function(num,rowId){
	var gainSharingId = "";
	var addNum="100";//比例总数
	var allInt = 0;//
	var houseEnter = $("#houseEnter").val();
	var dealMan = $("#dealMan").val();
	var collKeysMan = $("#collKeysMan").val();
	var collRoomMan = $("#collRoomMan").val();
	var realProMan=$("#realProMan").val();
	var startTime= $(":input[name='openStartTime']").val();
	var endTime= $(":input[name='openEndTime']").val();
	gainSharingId = rowId;
	if(startTime==""||endTime==""){
		alert("请填写时间范围！");
		return false;
	}
	if(!aihome.validateFunction().form()) {
		return false;
	}
	allInt = parseInt(houseEnter)+parseInt(dealMan)+parseInt(collKeysMan)+parseInt(collRoomMan)+parseInt(realProMan);
	if(allInt>100){
		alert("填写比例之和超出规定范围!");
		return false;
	}
	$.ajax({
	      type: "post",
	      url: "${CTX}/sys/editGainSharing.do", 
	      async:false,
	      dataType:'json',
	      data: {"gainSharingId":gainSharingId,"startTime":startTime,"endTime":endTime,"num":num,"houseEnter":houseEnter,"dealMan":dealMan,"collKeysMan":collKeysMan,"collRoomMan":collRoomMan,"realProMan":realProMan},
	      success: function(data){
			if(data == 2){
				alert("保存成功");
			}else if(data==3){
		   		alert("修改成功");
	   		}else{
	   			alert("系统异常");
	   			return false;
	   		}
	      }
	});
    return true;
};

$(function(){
	aihome.validateFunction();
})
</script>


