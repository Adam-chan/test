<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="layout">

  <sql id="Base_Layout_List" >
    id, UNITS_ID unitsId, PREMISES_ID premisesId, LAYOUT_NAME layoutName, ROOM room, OFFICE office, WC wc, BALCONY balcony, 
    COVERED_AREA coveredArea, USED_AREA usedArea, UNIT_PRICE unitPrice, TOTAL_PRICE totalPrice, 
    ORIENTATION orientation, FOLDER_NAME folderName, FILE_NAME fileName, CREATE_TIME createTime
  </sql>
     	
    <!-- 分页查询楼盘/单元户型 -->
   	<select id="getPremisesLayoutForPage" parameterType="map" resultType="layoutModel">
		SELECT
    	<include refid="Base_Layout_List" />
		FROM
			BUILDING_LAYOUT 
		WHERE
			PREMISES_ID = #{premisesId}
		<if test="layoutName != null and layoutName != ''">
			AND LAYOUT_NAME = #{layoutName}
		</if>
			AND STATUS = 1
		ORDER BY
			ID
   	</select>
    
    <!-- 查询楼盘户型名称List -->
    <select id="getLayoutNameList" parameterType="map" resultType="layoutModel">
		SELECT 
			LAYOUT_NAME layoutName
		FROM 
			BUILDING_LAYOUT 
		WHERE
			PREMISES_ID = #{id}
		AND STATUS = 1
		GROUP BY 
			LAYOUT_NAME
   	</select>
   			
   	<!-- 根据id查询户型 -->
   	<select id="getLayoutById" parameterType="map" resultType="layoutModel">
		SELECT
    	<include refid="Base_Layout_List" />
		FROM
			BUILDING_LAYOUT 
		WHERE
			ID = #{id}
		AND
		 	STATUS = 1
   	</select>
   	
	<!-- 新增户型 -->
	<insert id="insertLayout" parameterType="map">  
       INSERT INTO BUILDING_LAYOUT (
			ID,
			PREMISES_ID,
			LAYOUT_NAME,
			ROOM,
			OFFICE,
			WC,
			BALCONY,
			COVERED_AREA,
			USED_AREA,
			UNIT_PRICE,
			TOTAL_PRICE,
			ORIENTATION,
			FOLDER_NAME,
			FILE_NAME,
			CREATE_TIME,
			STATUS
		)VALUES(
			BUILDING_LAYOUT_SEQ.NEXTVAL, 
		    #{premisesId}, 
			#{layoutName}, 
			#{room}, 
			#{office}, 
			#{wc}, 
			#{balcony}, 
			#{coveredArea}, 
			#{usedArea}, 
			#{unitPrice}, 
			#{totalPrice}, 
			#{orientation}, 
			#{folderName},
			#{fileName}, 
			SYSDATE,
			1
		)
    </insert>

	<!-- 修改户型 -->
   	<update id="updateLayout" parameterType="map">             
	     UPDATE 
	     	BUILDING_LAYOUT
		 SET 		 	 
			PREMISES_ID = #{premisesId}, 
			LAYOUT_NAME = #{layoutName}, 
			ROOM = #{room}, 
			OFFICE = #{office},
			WC = #{wc},
			BALCONY = #{balcony}, 
			COVERED_AREA = #{coveredArea},
			USED_AREA = #{usedArea},
			UNIT_PRICE = #{unitPrice},
			TOTAL_PRICE = #{totalPrice}, 
			ORIENTATION = #{orientation},
			FOLDER_NAME = #{folderName},
			FILE_NAME = #{fileName}
		WHERE
			ID = #{id}
	</update> 

   	<!-- 删除户型 -->
	<delete id="delete" parameterType="map" >
	     UPDATE BUILDING_LAYOUT  
	     SET 
		 	 STATUS = 2
		 WHERE
		 	ID = #{id}
	</delete>
	
</mapper>