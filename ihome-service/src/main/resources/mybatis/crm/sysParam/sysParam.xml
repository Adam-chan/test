<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="sysParam" >
	<!-- 1级 -->
	<resultMap id="sysHouseMap" type="sysParameterModel">
		<result property="sysHouseType" column="type"/>
		<collection property="sysHouseList" resultMap="sysHouseMapList"/>
	</resultMap>
	<!-- 2级 -->
	<resultMap id="sysHouseMapList" type="sysParameterModel">
		<id property="id" column="id"/>
		<result property="sysHouseType" column="sysHouseType"/>
		<result property="sysHouseDescribe" column="sysHouseDescribe"/>
		<result property="sysHouseSort" column="sysHouseSort" />
	</resultMap>
	<!-- 查询房源全部系统参数 -->
	<select id="getSysHouseAllList" resultMap="sysHouseMap">
		select 
	      t.type,
	      t1.id,
	      t1.TYPE as sysHouseType,
	      t1.SORT as sysHouseSort,
	      t1.DESCRIBE  as sysHouseDescribe 
	    from sys_house_parame t
	    left join  sys_house_parame t1  on t.type =t1.type
	    order by t.type,t1.SORT
	</select>
	
		<!-- 查询房源指定系统参数 -->
	<select id="getSysHouseList" parameterType="map" resultType="sysParameterModel">
		select 
			id,
			TYPE as sysHouseType,
			SORT as sysHouseSort,
			DESCRIBE as sysHouseDescribe
		from SYS_HOUSE_PARAME
		<where>
			<if test="sysHouseSort != null  and sysHouseSort !=''"> 
		     	SORT = #{sysHouseSort}
		    </if>
		    <if test="sysHouseDescribe != null  and sysHouseDescribe !=''"> 
		     	and DESCRIBE = #{sysHouseDescribe}
		    </if>
		    <if test="sysHouseType != null  and sysHouseType !=''"> 
		     	and TYPE = #{sysHouseType}
		    </if> 
		      <if test="sysHouseId != null  and sysHouseId !=''"> 
		     	and id in (${sysHouseId})
		    </if>
		</where>
		order by SORT
	</select>
		<!-- 查询房源系统参数 -->
	<select id="getSysHouseCount" parameterType="map" resultType="sysParameterModel">
		select 
			count(0) as sysCount
		from SYS_HOUSE_PARAME
	where TYPE = #{sysHouseType}
	</select>
	<!-- 新增房源系统参数 -->
	<insert id="insertSysHouse" parameterType="map">
		insert into SYS_HOUSE_PARAME
		(ID,TYPE
		<if test="sysHouseSort != null  and sysHouseSort !=''"> 
	     	,SORT
	    </if>
		,DESCRIBE
		)
		values(
			SYS_HOUSE_PARAME_SEQ.NEXTVAL,
			#{sysHouseType}
			<if test="sysHouseSort != null  and sysHouseSort !=''"> 
	     		,#{sysHouseSort}
	    	</if>
	    	<if test="sysHouseDescribe != null  and sysHouseDescribe !=''"> 
	     		,#{sysHouseDescribe}
	    	</if>
	    )
	</insert>
	
	<!-- 修改房源系统参数 -->
	<update id="updateSysHouse" parameterType="map">
		update SYS_HOUSE_PARAME
		<set>
			<if test="sysHouseDescribe != null and sysHouseDescribe != ''">
				DESCRIBE = #{sysHouseDescribe},
			</if>
			<if test="sysHouseSort != null and sysHouseSort != ''">
				SORT = #{sysHouseSort}
			</if>
		</set>
		<where>
			<if test="sysHouseId != null and sysHouseId != ''">
				 id = #{sysHouseId}
			</if>
		</where> 
	</update>
	 <!-- 删除房源系统参数-->
	<delete id="deleteSysHouse" parameterType="map" >
	  	delete from SYS_HOUSE_PARAME
	  	<where>
			<if test="sysHouseId != null and sysHouseId != ''">
				id = #{sysHouseId}
			</if>
		</where>
	</delete>
	<!-- 分页查询收益分成比例 -->
	<select id="getGainSharingPage" parameterType="map" resultType="sysParameterModel">
		SELECT
			ID as gainSharingId,
			START_TIME as startTime,
			END_TIME as endTime,
			HOUSE_ENTER as houseEnter,
			DEAL_MAN as dealMan ,
			COLL_KEYS_MAN as collKeysMan,
			COLL_ROOM_MAN as collRoomMan,
			REAL_PRO_MAN as realProMan
		FROM SYS_GAIN_SHARING
		<where>
			<if test="startTime != null and startTime != ''">
				 START_TIME  &gt; TO_DATE(#{startTime},'YYYY-MM-DD')
			</if>
			<if test="endTime != null and endTime != ''">
				AND END_TIME &lt; TO_DATE(#{endTime},'YYYY-MM-DD')
			</if>
			<if test="gainSharingId != null and gainSharingId != ''">
				AND ID= #{gainSharingId}
			</if>
		</where>
			ORDER BY id DESC
	</select>
		<!-- 获取收益分成比例参数数据 -->
	<select id="getGainSharingInfo" parameterType="map" resultType="sysParameterModel">
		SELECT
			ID as gainSharingId,
			START_TIME as startTime,
			END_TIME as endTime,
			HOUSE_ENTER as houseEnter,
			DEAL_MAN as dealMan ,
			COLL_KEYS_MAN as collKeysMan,
			COLL_ROOM_MAN as collRoomMan,
			REAL_PRO_MAN as realProMan
		FROM SYS_GAIN_SHARING
		where ID = #{gainSharingId}
		ORDER BY ID DESC
	</select>
		<!-- 新增收益分成比例参数 -->
	<insert id="insertGainSharing" parameterType="map">
		insert into SYS_GAIN_SHARING
			(
				ID, 
				START_TIME,
				END_TIME,
				HOUSE_ENTER,
				DEAL_MAN,
				COLL_KEYS_MAN,
				COLL_ROOM_MAN,
				REAL_PRO_MAN
			)
		values(
			SYS_GAIN_SHARING_SEQ.NEXTVAL,
			TO_DATE(#{startTime},'YYYY-MM-DD'),
			TO_DATE(#{endTime},'YYYY-MM-DD'),
			#{houseEnter},#{dealMan},
			#{collKeysMan},#{collRoomMan},
			#{realProMan}
		)
	</insert>
	
	<!-- 修改收益分成比例参数-->
	<update id="updateGainSharing" parameterType="map">
		update SYS_GAIN_SHARING
		<set>
			<if test="startTime != null and startTime != ''">
				START_TIME = TO_DATE(#{startTime},'YYYY-MM-DD')
			</if>
			<if test="endTime != null and endTime != ''">
				,END_TIME = TO_DATE(#{endTime},'YYYY-MM-DD')
			</if>
			<if test="houseEnter != null and houseEnter != ''">
				,HOUSE_ENTER = #{houseEnter}
			</if>
			<if test="dealMan != null and sysHouseSort != ''">
				,DEAL_MAN = #{dealMan}
			</if>
			<if test="collKeysMan != null and collKeysMan != ''">
				,COLL_KEYS_MAN = #{collKeysMan}
			</if>
			<if test="collRoomMan != null and collRoomMan != ''">
				,COLL_ROOM_MAN = #{collRoomMan}
			</if>
			<if test="realProMan != null and realProMan != ''">
				,REAL_PRO_MAN = #{realProMan}
			</if>
		</set>
		where	ID = #{gainSharingId}
	</update>
		  <!-- 删除收益分成比例参数-->
	  <delete id="deleteGainSharing" parameterType="map" >
	    	delete from SYS_GAIN_SHARING
	    	where ID in(${gainSharingId})
	  </delete>
	 
	 	<!-- 1级 -->
	<resultMap id="sysCoustomerMap" type="sysParameterModel">
		<result property="sysCoustomerType" column="type"/>
		<collection property="sysCoustomerList" resultMap="sysCoustomerMapList"/>
	</resultMap>
	<!-- 2级 -->
	<resultMap id="sysCoustomerMapList" type="sysParameterModel">
		<id property="id" column="id"/>
		<result property="sysCoustomerType" column="sysCoustomerType"/>
		<result property="sysCoustomerDescribe" column="sysCoustomerDescribe"/>
		<result property="sysCoustomerDescribeStr" column="sysCoustomerDescribeStr"/>
		<result property="sysCoustomerSort" column="sysCoustomerSort" />
		<result property="sysCoustomerTDescribe" column="sysCoustomerTDescribe" />
	</resultMap>
	 	 
	  	<!-- 查询客源系统参数 -->
	<select id="getSysCustomerAllList"  resultMap="sysCoustomerMap">
		select 
			t.type,
			t1.id,
			t1.TYPE as sysCoustomerType,
			t1.SORT as sysCoustomerSort,
			t1.DESCRIBE  as sysCoustomerDescribe,
			CASE t1.DESCRIBE
			WHEN '1' THEN '经纪人'
			WHEN '2' THEN '店长'
			WHEN '3' THEN '区经理'
			ELSE '其他' END sysCoustomerDescribeStr,
			t1.SEVERAL_DESCRIBE as sysCoustomerTDescribe
		from SYS_CUSTOMER_PARAME t
		left join SYS_CUSTOMER_PARAME t1 on t1.type =t.type
		order by t.type,t1.SORT
	</select>
	  	<!-- 查询客源系统参数 -->
	<select id="getSysCustomerList" parameterType="map" resultType="sysParameterModel">
		select 
			id,
			TYPE as sysCoustomerType,
			SORT as sysCoustomerSort,
			DESCRIBE as sysCoustomerDescribe,
			CASE DESCRIBE
			WHEN '1' THEN '经纪人'
			WHEN '2' THEN '店长'
			WHEN '3' THEN '区经理'
			ELSE '其他' END sysCoustomerDescribeStr,
			SEVERAL_DESCRIBE as sysCoustomerTDescribe
		from SYS_CUSTOMER_PARAME
	<where>
		<if test="sysCoustomerSort != null  and sysCoustomerSort !=''"> 
	     	SORT = #{sysCoustomerSort}
	    </if>
	    <if test="sysCoustomerDescribe != null  and sysCoustomerDescribe !=''"> 
	     	and DESCRIBE = #{sysCoustomerDescribe}
	    </if>
	    <if test="sysCoustomerType != null  and sysCoustomerType !=''"> 
	     	and TYPE = #{sysCoustomerType}
	    </if>
	</where>
		order by SORT
	</select>
	<!-- 新增客源系统参数 -->
	<insert id="insertSysCustomer" parameterType="map">
		insert into SYS_CUSTOMER_PARAME
		(id,TYPE
		<if test="sysCoustomerSort != null  and sysCoustomerSort !=''"> 
	     	,SORT
	    </if>
	    <if test="sysCoustomerDescribe != null  and sysCoustomerDescribe !=''"> 
	     	,DESCRIBE
	    </if>
	    <if test="sysCoustomerTDescribe != null  and sysCoustomerTDescribe !=''"> 
	     	,SEVERAL_DESCRIBE
	    </if>
		)
		values(
			SYS_CUSTOMER_PARAME_SEQ.NEXTVAL,
			#{sysCoustomerType}
			<if test="sysCoustomerSort != null  and sysCoustomerSort !=''"> 
	     		,#{sysCoustomerSort}
	    	</if>
	    	<if test="sysCoustomerDescribe != null  and sysCoustomerDescribe !=''"> 
	     		,#{sysCoustomerDescribe}
	    	</if>
	    	<if test="sysCoustomerTDescribe != null  and sysCoustomerTDescribe !=''"> 
	     		,#{sysCoustomerTDescribe}
	    	</if>
	    )
	</insert>
	
	<!-- 修改客源系统参数 -->
	<update id="updateSysCustomer" parameterType="map">
		update SYS_CUSTOMER_PARAME
		<set>
			<if test="sysCoustomerDescribe != null and sysCoustomerDescribe != ''">
				DESCRIBE = #{sysCoustomerDescribe},
			</if>
			<if test="sysCoustomerSort != null and sysCoustomerSort != ''">
				SORT = #{sysCoustomerSort},
			</if>
			<if test="sysCoustomerTDescribe != null and sysCoustomerTDescribe != ''">
				SEVERAL_DESCRIBE = #{sysCoustomerTDescribe}
			</if>
		</set>
		<where>
			<if test="sysCoustomId != null and sysCoustomId != ''">
				id = #{sysCoustomId}
			</if>
		</where> 
	</update>
	 <!-- 删除客源系统参数-->
	<delete id="deleteSysCustomer" parameterType="map" >
	  	delete from SYS_CUSTOMER_PARAME
	  	<where>
			<if test="sysCoustomId != null and sysCoustomId != ''">
				id = #{sysCoustomId}
			</if>
		</where>
	</delete>
		<!-- 查询房源系统参数 -->
	<select id="getSysCustomerCount" parameterType="map" resultType="sysParameterModel">
		select 
			count(0) as sysCount
		from SYS_CUSTOMER_PARAME
	where TYPE = #{sysCoustomerType}
	</select>
	
	
	<!-- 1级 -->
	<resultMap id="sysOtherMap" type="sysParameterModel">
		<result property="sysOtherType" column="type"/>
		<collection property="sysOtherList" resultMap="sysOtherMapList"/>
	</resultMap>
	<!-- 2级 -->
	<resultMap id="sysOtherMapList" type="sysParameterModel">
		<id property="id" column="id"/>
		<result property="sysOtherType" column="sysOtherType"/>
		<result property="sysOtherDescribe" column="sysOtherDescribe"/>
		<result property="sysOtherSort" column="sysOtherSort" />
	</resultMap>
	<!-- 查询其他全部系统参数 -->
	<select id="getSysOtherAllList" resultMap="sysOtherMap">
		select 
			t2.type,
			t.id,
			t.TYPE as sysOtherType,
			t.SORT as sysOtherSort,
			t.DESCRIBE  as sysOtherDescribe 
		from SYS_OTHER_PARAME t
		left join (select t1.type from SYS_OTHER_PARAME t1 group by t1.type)t2 on t2.type =t.type
		order by t2.type,SORT
	</select>
		<!-- 查询其他指定系统参数 -->
	<select id="getSysOtherList" parameterType="map" resultType="sysParameterModel">
		select 
			id,
			TYPE as sysOtherType,
			SORT as sysOtherSort,
			DESCRIBE as sysOtherDescribe
		from SYS_OTHER_PARAME
		<where>
			<if test="sysOtherSort != null  and sysOtherSort !=''"> 
		     	SORT = #{sysOtherSort}
		    </if>
		    <if test="sysOtherDescribe != null  and sysOtherDescribe !=''"> 
		     	and DESCRIBE = #{sysOtherDescribe}
		    </if>
		    <if test="sysOtherType != null  and sysOtherType !=''"> 
		     	and TYPE = #{sysOtherType}
		    </if>
		</where>
		order by SORT
	</select>
		<!-- 查询其他系统参数数量 -->
	<select id="getSysOtherCount" parameterType="map" resultType="sysParameterModel">
		select 
			count(0) as sysCount
		from SYS_OTHER_PARAME
	where TYPE = #{sysOtherType}
	</select>
	<!-- 新增其他系统参数 -->
	<insert id="insertSysOther" parameterType="map">
		insert into SYS_OTHER_PARAME
		(ID,TYPE
		<if test="sysOtherSort != null  and sysOtherSort !=''"> 
	     	,SORT
	    </if>
		,DESCRIBE
		)
		values(
			SYS_OTHER_PARAME_SEQ.NEXTVAL,
			#{sysOtherType}
			<if test="sysOtherSort != null  and sysOtherSort !=''"> 
	     		,#{sysOtherSort}
	    	</if>
	    	<if test="sysOtherDescribe != null  and sysOtherDescribe !=''"> 
	     		,#{sysOtherDescribe}
	    	</if>
	    )
	</insert>
	
	<!-- 修改其他系统参数 -->
	<update id="updateSysOther" parameterType="map">
		update SYS_OTHER_PARAME
		<set>
			<if test="sysOtherDescribe != null and sysOtherDescribe != ''">
				DESCRIBE = #{sysOtherDescribe},
			</if>
			<if test="sysOtherSort != null and sysOtherSort != ''">
				SORT = #{sysOtherSort}
			</if>
		</set>
		<where>
			<if test="sysOtherId != null and sysOtherId != ''">
				 id = #{sysOtherId}
			</if>
		</where> 
	</update>
	 <!-- 删除其他系统参数-->
	<delete id="deleteSysOther" parameterType="map" >
	  	delete from SYS_OTHER_PARAME
	  	<where>
			<if test="sysOtherId != null and sysOtherId != ''">
				id = #{sysOtherId}
			</if>
		</where>
	</delete>
</mapper>