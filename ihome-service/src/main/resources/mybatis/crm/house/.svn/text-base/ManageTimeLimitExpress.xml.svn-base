<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="manageTimeLimitExpress" >
  <!-- 限时速递查询字段  -->
  <sql id="Base_Column_List" >
    ID as id, HOUSE_INFO_ID as houseInfoId, LIMITTIME_CONTRACT_NUM as limittimeContractNum, 
    LIMITTIME_SERIAL_NUM as limittimeSerialNum, CODE as code,CODE_ADDRESS as codeAddress, 
    PROPERTY_CERTIFICATE_NUM as propertyCertificateNum,ENTRUST_STARTIME as entrustStartime,
    ENTRUST_ENDTIME as entrustEndtime, CONTRACT_DATE as contractDate, PAMENT as pament, 
    PAMENT_WAY as pamentWay, PAMENT_AMOUNT as pamentAmount,LIMITTIME_BOND as limittimeBond,
    LIMIT_USER as limitUser,RECYCLE_HOUSE_SHOP as recycleHouseShop, OPERATE_USER as operateUser, 
    OPERATE_USER_ID as operateUserId, CREATE_TIME as createTime, STATUS as status, 
    END_REASON as endReason, TYPE as type,CONTACT_PHONE as contactPhone,
    PROPRIETOR as proprietor,PROPRIETOR_CERTIFICATE_NUM as proprietorCertificateNum,	         
	PROPRIETOR_CERTIFICATE_TYPE as proprietorCertificateType,ORIGINAL_CONTRACT as originalContract,	
	LIMIT_USER_ID as limitUserId,LIMIT_USER_ORG as limitUserOrg,LIMIT_USER_AREA as limitUserArea,  
	LIMIT_USER_BIG_AREA	as limitUserBigArea,LIMIT_USER_CODE as limitUserCode,OPERATE_TIME as operateTime              
 </sql>
   <!-- 根据房源id 和 合同状态做校验 -->
  <select id="getBycount" resultType="java.lang.Integer" parameterType="map" >
    select 
   		count(0)
    from MANAGE_TIME_LIMIT_EXPRESS
    <where>
   		<if test="houseInfoId != null and houseInfoId !='' ">
   			HOUSE_INFO_ID=#{houseInfoId}
   		</if>
   		<if test="status != null and status!=''">
   			and STATUS &lt;&gt; #{status}
   		</if>
    </where>
  </select>
  <!-- 根据条件获取限时速递数据 -->
  <select id="getManageTimeLimitExpress" resultType="manageTimeLimitExpressModel" parameterType="map" >
    select 
   		<include refid="Base_Column_List" />
    from MANAGE_TIME_LIMIT_EXPRESS
   	<where>
   		<if test="id != null and id !='' ">
   			ID = #{id}
   		</if>
    </where>
 	order by LIMITTIME_CONTRACT_NUM
  </select>
   <!-- 获取限时速递有效的一条数据 LB-->
  <select id="getTimeLimitInfo" resultType="manageTimeLimitExpressModel" parameterType="map" >
 	   select
		      id,
		      limitUser,
		      limitUserOrg,
		      to_char(operateTime,'yyyy-mm-dd hh24:mi:ss') as operateTime
	 from (select
	 		ID as id,
	 		LIMIT_USER as limitUser,
	 		LIMIT_USER_ORG as limitUserOrg,
	 		OPERATE_TIME as operateTime
   			from MANAGE_TIME_LIMIT_EXPRESS
			  WHERE  HOUSE_INFO_ID = #{houseInfoId} order by id desc )a
	     where rownum = 1
  </select>
  <!-- 根据条件删除显示速递 -->
  <delete id="deleteByPrimaryKey" parameterType="map" >
    delete from MANAGE_TIME_LIMIT_EXPRESS
    where ID = #{id,jdbcType=DECIMAL}
  </delete>
  <!-- 插入限时速数据 -->
  <insert id="insert" parameterType="map" >
    insert into MANAGE_TIME_LIMIT_EXPRESS (ID, HOUSE_INFO_ID, LIMITTIME_CONTRACT_NUM, 
      LIMITTIME_SERIAL_NUM, CODE, CODE_ADDRESS, 
      PROPERTY_CERTIFICATE_NUM, ENTRUST_STARTIME, ENTRUST_ENDTIME, 
      CONTRACT_DATE, PAMENT, PAMENT_WAY, 
      PAMENT_AMOUNT, LIMITTIME_BOND, LIMIT_USER, 
      RECYCLE_HOUSE_SHOP, OPERATE_USER, OPERATE_USER_ID, 
      CREATE_TIME, STATUS, END_REASON,TYPE,CONTACT_PHONE,PROPRIETOR,
      PROPRIETOR_CERTIFICATE_NUM,PROPRIETOR_CERTIFICATE_TYPE,ORIGINAL_CONTRACT,
      LIMIT_USER_ID,LIMIT_USER_ORG,LIMIT_USER_AREA,  
	  LIMIT_USER_BIG_AREA,LIMIT_USER_CODE,OPERATE_TIME   
      )
    values (MANAGE_TIME_LIMIT_EXPRESS_SEQ.NEXTVAL, #{houseInfoId,jdbcType=DECIMAL}, #{limittimeContractNum,jdbcType=VARCHAR}, 
      #{limittimeSerialNum,jdbcType=VARCHAR}, #{code,jdbcType=VARCHAR}, #{codeAddress,jdbcType=VARCHAR}, 
      #{propertyCertificateNum,jdbcType=VARCHAR}, #{entrustStartime,jdbcType=DATE}, #{entrustEndtime,jdbcType=DATE}, 
      #{contractDate,jdbcType=DATE}, #{pament,jdbcType=DECIMAL}, #{pamentWay,jdbcType=DECIMAL}, 
      #{pamentAmount,jdbcType=DECIMAL}, #{limittimeBond,jdbcType=DECIMAL}, #{limitUser,jdbcType=VARCHAR}, 
      #{recycleHouseShop,jdbcType=VARCHAR}, #{operateUser,jdbcType=VARCHAR}, #{operateUserId,jdbcType=VARCHAR}, 
      SYSDATE, #{status,jdbcType=DECIMAL}, #{endReason,jdbcType=CLOB},#{type,jdbcType=DECIMAL},
      #{contactPhone,jdbcType=VARCHAR},#{proprietor,jdbcType=VARCHAR},#{proprietorCertificateNum,jdbcType=VARCHAR},
      #{proprietorCertificateType,jdbcType=DECIMAL}, #{originalContract,jdbcType=VARCHAR},
      #{limitUserId,jdbcType=VARCHAR}, #{limitUserOrg,jdbcType=VARCHAR}, #{limitUserArea,jdbcType=VARCHAR},
      #{limitUserBigArea,jdbcType=VARCHAR}, #{limitUserCode,jdbcType=VARCHAR}, #{operateTime,jdbcType=VARCHAR}
      )
  </insert>
  <!-- 有选择的插入限时速递 -->
  <insert id="insertSelective" parameterType="map" >
  	<selectKey resultType="java.lang.Integer" order="BEFORE" keyProperty="id">
	SELECT MANAGE_TIME_LIMIT_EXPRESS_SEQ.NEXTVAL FROM DUAL
	</selectKey>
    insert into MANAGE_TIME_LIMIT_EXPRESS
    <trim prefix="(" suffix=")" suffixOverrides="," >
        ID,
      <if test="houseInfoId != null and houseInfoId != ''" >
        HOUSE_INFO_ID,
      </if>
      <if test="limittimeContractNum != null and limittimeContractNum != ''" >
        LIMITTIME_CONTRACT_NUM,
      </if>
      <if test="limittimeSerialNum != null and limittimeSerialNum != ''" >
        LIMITTIME_SERIAL_NUM,
      </if>
      <if test="code != null and code != ''" >
        CODE,
      </if>
      <if test="codeAddress != null and codeAddress != ''" >
        CODE_ADDRESS,
      </if>
      <if test="propertyCertificateNum != null and propertyCertificateNum != ''" >
        PROPERTY_CERTIFICATE_NUM,
      </if>
      <if test="entrustStartime != null and entrustStartime != ''" >
        ENTRUST_STARTIME,
      </if>
      <if test="entrustEndtime != null  and entrustEndtime != ''" >
        ENTRUST_ENDTIME,
      </if>
      <if test="contractDate != null  and contractDate != ''" >
        CONTRACT_DATE,
      </if>
      <if test="pament != null  and pament != ''" >
        PAMENT,
      </if>
      <if test="pamentWay != null  and pamentWay != ''" >
        PAMENT_WAY,
      </if>
      <if test="pamentAmount != null  and pamentAmount != ''" >
        PAMENT_AMOUNT,
      </if>
      <if test="limittimeBond != null  and limittimeBond != ''" >
        LIMITTIME_BOND,
      </if>
      <if test="limitUser != null  and limitUser != ''" >
        LIMIT_USER,
      </if>
      <if test="recycleHouseShop != null and recycleHouseShop != ''" >
        RECYCLE_HOUSE_SHOP,
      </if>
      <if test="operateUser != null  and operateUser != ''" >
        OPERATE_USER,
      </if>
      <if test="operateUserId != null and operateUserId != ''" >
        OPERATE_USER_ID,
      </if>
    	CREATE_TIME,
      <if test="status != null and status != ''" >
        STATUS,
      </if>
      <if test="endReason != null and endReason != ''" >
        END_REASON,
      </if>
        <if test="type != null and type != ''" >
        TYPE,
      </if>
        <if test="contactPhone != null and contactPhone != ''" >
        CONTACT_PHONE,
      </if>
        <if test="proprietor != null and proprietor != ''" >
        PROPRIETOR,
      </if>
        <if test="proprietorCertificateNum != null and proprietorCertificateNum != ''" >
        PROPRIETOR_CERTIFICATE_NUM,
      </if>
        <if test="proprietorCertificateType != null and proprietorCertificateType != ''" >
        PROPRIETOR_CERTIFICATE_TYPE,
      </if>
      <if test="originalContract != null and originalContract != ''" >
        ORIGINAL_CONTRACT,
      </if> 
        <if test="limitUserId != null and limitUserId != ''" >
        LIMIT_USER_ID,
      </if> 
        <if test="limitUserOrg != null and limitUserOrg != ''" >
        LIMIT_USER_ORG,
      </if> 
        <if test="limitUserArea != null and limitUserArea != ''" >
        LIMIT_USER_AREA,
      </if> 
        <if test="limitUserBigArea != null and limitUserBigArea != ''" >
        LIMIT_USER_BIG_AREA,
      </if>   <if test="limitUserCode != null and limitUserCode != ''" >
        LIMIT_USER_CODE,
      </if> 
        <if test="operateTime != null and operateTime != ''" >
        OPERATE_TIME
      </if> 
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
        #{id},
      <if test="houseInfoId != null and houseInfoId != ''" >
        #{houseInfoId,jdbcType=DECIMAL},
      </if>
      <if test="limittimeContractNum != null and limittimeContractNum != ''" >
        #{limittimeContractNum,jdbcType=VARCHAR},
      </if>
      <if test="limittimeSerialNum != null and limittimeSerialNum != ''" >
        #{limittimeSerialNum,jdbcType=VARCHAR},
      </if>
      <if test="code != null and code != ''" >
        #{code,jdbcType=VARCHAR},
      </if>
      <if test="codeAddress != null and codeAddress != ''" >
        #{codeAddress,jdbcType=VARCHAR},
      </if>
      <if test="propertyCertificateNum != null and propertyCertificateNum != ''" >
        #{propertyCertificateNum,jdbcType=VARCHAR},
      </if>
      <if test="entrustStartime != null and entrustStartime != ''" >
        #{entrustStartime,jdbcType=DATE},
      </if>
      <if test="entrustEndtime != null and entrustEndtime != ''" >
        #{entrustEndtime,jdbcType=DATE},
      </if>
      <if test="contractDate != null and contractDate != ''" >
        #{contractDate,jdbcType=DATE},
      </if>
      <if test="pament != null and pament != ''" >
        #{pament,jdbcType=DECIMAL},
      </if>
      <if test="pamentWay != null and pamentWay != ''" >
        #{pamentWay,jdbcType=DECIMAL},
      </if>
      <if test="pamentAmount != null and pamentAmount != ''" >
        #{pamentAmount,jdbcType=DECIMAL},
      </if>
      <if test="limittimeBond != null and limittimeBond != ''" >
        #{limittimeBond,jdbcType=DECIMAL},
      </if>
      <if test="limitUser != null and limitUser != ''" >
        #{limitUser,jdbcType=VARCHAR},
      </if>
      <if test="recycleHouseShop != null and recycleHouseShop != ''" >
        #{recycleHouseShop,jdbcType=VARCHAR},
      </if>
      <if test="operateUser != null and operateUser != ''" >
        #{operateUser,jdbcType=VARCHAR},
      </if>
      <if test="operateUserId != null and operateUserId != ''" >
        #{operateUserId,jdbcType=VARCHAR},
      </if>
       SYSDATE,
      <if test="status != null and status != ''" >
        #{status,jdbcType=DECIMAL},
      </if>
      <if test="endReason != null and endReason != ''" >
        #{endReason,jdbcType=CLOB},
      </if>
       <if test="type != null and type != ''" >
        #{type,jdbcType=DECIMAL},
      </if>
       <if test="contactPhone != null and contactPhone != ''" >
        #{contactPhone,jdbcType=VARCHAR},
      </if>
       <if test="proprietor != null and proprietor != ''" >
        #{proprietor,jdbcType=VARCHAR},
      </if>
       <if test="proprietorCertificateNum != null and proprietorCertificateNum != ''" >
        #{proprietorCertificateNum,jdbcType=VARCHAR},
      </if>
       <if test="proprietorCertificateType != null and proprietorCertificateType != ''" >
        #{proprietorCertificateType,jdbcType=DECIMAL},
      </if>
       <if test="originalContract != null and originalContract != ''" >
        #{originalContract,jdbcType=VARCHAR},
      </if>
       <if test="limitUserId != null and limitUserId != ''" >
        #{limitUserId,jdbcType=VARCHAR},
      </if> 
      <if test="limitUserOrg != null and limitUserOrg != ''" >
        #{limitUserOrg,jdbcType=VARCHAR},
      </if> 
      <if test="limitUserArea != null and limitUserArea != ''" >
        #{limitUserArea,jdbcType=VARCHAR},
      </if>
       <if test="limitUserBigArea != null and limitUserBigArea != ''" >
        #{limitUserBigArea,jdbcType=VARCHAR},
      </if>
       <if test="limitUserCode != null and limitUserCode != ''" >
        #{limitUserCode,jdbcType=VARCHAR},
      </if>
       <if test="operateTime != null and operateTime != ''" >
        #{operateTime,jdbcType=VARCHAR},
      </if>
    </trim>
  </insert>
  <!-- 有选择的跟新限时速递 -->
  <update id="updateSelective" parameterType="map" >
    update MANAGE_TIME_LIMIT_EXPRESS
    <set >
      <if test="houseInfoId != null" >
        HOUSE_INFO_ID = #{houseInfoId,jdbcType=DECIMAL},
      </if>
      <if test="limittimeContractNum != null" >
        LIMITTIME_CONTRACT_NUM = #{limittimeContractNum,jdbcType=VARCHAR},
      </if>
      <if test="limittimeSerialNum != null" >
        LIMITTIME_SERIAL_NUM = #{limittimeSerialNum,jdbcType=VARCHAR},
      </if>
      <if test="code != null" >
        CODE = #{code,jdbcType=VARCHAR},
      </if>
      <if test="codeAddress != null" >
        CODE_ADDRESS = #{codeAddress,jdbcType=VARCHAR},
      </if>
      <if test="propertyCertificateNum != null" >
        PROPERTY_CERTIFICATE_NUM = #{propertyCertificateNum,jdbcType=VARCHAR},
      </if>
      <if test="entrustStartime != null" >
        ENTRUST_STARTIME = #{entrustStartime,jdbcType=DATE},
      </if>
      <if test="entrustEndtime != null" >
        ENTRUST_ENDTIME = #{entrustEndtime,jdbcType=DATE},
      </if>
      <if test="contractDate != null" >
        CONTRACT_DATE = #{contractDate,jdbcType=DATE},
      </if>
      <if test="pament != null" >
        PAMENT = #{pament,jdbcType=DECIMAL},
      </if>
      <if test="pamentWay != null" >
        PAMENT_WAY = #{pamentWay,jdbcType=DECIMAL},
      </if>
      <if test="pamentAmount != null" >
        PAMENT_AMOUNT = #{pamentAmount,jdbcType=DECIMAL},
      </if>
      <if test="limittimeBond != null" >
        LIMITTIME_BOND = #{limittimeBond,jdbcType=DECIMAL},
      </if>
      <if test="divideUser != null" >
        LIMIT_USER = #{divideUser,jdbcType=VARCHAR},
      </if>
      <if test="recycleHouseShop != null" >
        RECYCLE_HOUSE_SHOP = #{recycleHouseShop,jdbcType=VARCHAR},
      </if>
      <if test="operateUser != null" >
        OPERATE_USER = #{operateUser,jdbcType=VARCHAR},
      </if>
      <if test="operateUserId != null" >
        OPERATE_USER_ID = #{operateUserId,jdbcType=VARCHAR},
      </if>
      <if test="status != null" >
        STATUS = #{status,jdbcType=DECIMAL},
      </if>
      <if test="endReason != null" >
        END_REASON = #{endReason,jdbcType=CLOB},
      </if>
       <if test="type != null" >
        TYPE = #{type,jdbcType=DECIMAL},
      </if>
       <if test="contactPhone != null" >
        CONTACT_PHONE = #{contactPhone,jdbcType=VARCHAR},
      </if>
       <if test="proprietor != null" >
        PROPRIETOR = #{proprietor,jdbcType=VARCHAR},
      </if>
       <if test="proprietorCertificateNum != null" >
        PROPRIETOR_CERTIFICATE_NUM = #{proprietorCertificateNum,jdbcType=VARCHAR},
      </if>
       <if test="proprietorCertificateType != null" >
        PROPRIETOR_CERTIFICATE_TYPE = #{proprietorCertificateType,jdbcType=DECIMAL},
       </if>
       <if test="originalContract != null" >
        ORIGINAL_CONTRACT = #{originalContract,jdbcType=DECIMAL},
      </if>
       <if test="divideId != null" >
        LIMIT_USER_ID = #{divideId,jdbcType=VARCHAR},
      </if>
        <if test="divideOrg != null" >
        LIMIT_USER_ORG = #{divideOrg,jdbcType=VARCHAR},
      </if>
        <if test="divideQu != null" >
        LIMIT_USER_AREA = #{divideQu,jdbcType=VARCHAR},
      </if>
        <if test="divideDaQu != null" >
        LIMIT_USER_BIG_AREA = #{divideDaQu,jdbcType=VARCHAR},
      </if>
        <if test="divideOrgCode != null" >
        LIMIT_USER_CODE = #{divideOrgCode,jdbcType=VARCHAR},
      </if>
        OPERATE_TIME = SYSDATE,
    </set>
    where ID = #{id,jdbcType=DECIMAL}
  </update>
  <!-- 根据条件跟新限速递 -->
  <update id="updateByPrimaryKey" parameterType="map" >
    update MANAGE_TIME_LIMIT_EXPRESS
    set HOUSE_INFO_ID = #{houseInfoId,jdbcType=DECIMAL},
      LIMITTIME_CONTRACT_NUM = #{limittimeContractNum,jdbcType=VARCHAR},
      LIMITTIME_SERIAL_NUM = #{limittimeSerialNum,jdbcType=VARCHAR},
      CODE = #{code,jdbcType=VARCHAR},
      CODE_ADDRESS = #{codeAddress,jdbcType=VARCHAR},
      PROPERTY_CERTIFICATE_NUM = #{propertyCertificateNum,jdbcType=VARCHAR},
      ENTRUST_STARTIME = #{entrustStartime,jdbcType=DATE},
      ENTRUST_ENDTIME = #{entrustEndtime,jdbcType=DATE},
      CONTRACT_DATE = #{contractDate,jdbcType=DATE},
      PAMENT = #{pament,jdbcType=DECIMAL},
      PAMENT_WAY = #{pamentWay,jdbcType=DECIMAL},
      PAMENT_AMOUNT = #{pamentAmount,jdbcType=DECIMAL},
      LIMITTIME_BOND = #{limittimeBond,jdbcType=DECIMAL},
      LIMIT_USER = #{limitUser,jdbcType=VARCHAR},
      RECYCLE_HOUSE_SHOP = #{recycleHouseShop,jdbcType=VARCHAR},
      OPERATE_USER = #{operateUser,jdbcType=VARCHAR},
      OPERATE_USER_ID = #{operateUserId,jdbcType=VARCHAR},
      CREATE_TIME = SYSDATE,
      STATUS = #{status,jdbcType=DECIMAL},
   	  TYPE = #{type,jdbcType=DECIMAL},                        
  	  CONTACT_PHONE = #{contactPhone,jdbcType=VARCHAR}  ,            
      PROPRIETOR = #{proprietor,jdbcType=VARCHAR} ,                
      PROPRIETOR_CERTIFICATE_NUM = #{proprietorCertificateNum,jdbcType=VARCHAR},  
	  PROPRIETOR_CERTIFICATE_TYPE = #{proprietorCertificateType,jdbcType=DECIMAL},
	  ORIGINAL_CONTRACT = #{originalContract,jdbcType=VARCHAR},	
	  LIMIT_USER_ID = #{limitUserId,jdbcType=VARCHAR} ,
	  LIMIT_USER_ORG = #{limitUserOrg,jdbcType=VARCHAR} ,
	  LIMIT_USER_AREA = #{limitUserArea,jdbcType=VARCHAR} ,  
	  LIMIT_USER_BIG_AREA = #{limitUserBigArea,jdbcType=VARCHAR} ,
	  LIMIT_USER_CODE = #{limitUserCode,jdbcType=VARCHAR} ,
	  OPERATE_TIME = #{operateTime,jdbcType=VARCHAR}         
    where ID = #{id,jdbcType=DECIMAL}
  </update>
  <!-- 限时速递分页 -->
   <select id="getManageTimeLimitExpressPage" resultType="manageTimeLimitExpressModel" parameterType="map" >
    select 
   		<include refid="Base_Column_List" />
    from 
    	MANAGE_TIME_LIMIT_EXPRESS
    where
        HOUSE_INFO_ID = #{houseInfoId} 
  </select>
</mapper>